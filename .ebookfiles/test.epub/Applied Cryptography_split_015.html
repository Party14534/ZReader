<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Applied Cryptography, Second Edition: Protocols, Algorithms, and Source Code in C</title>
    <meta content="Bruce Schneier" name="author"/>
    <meta content="An introduction to cryptography." name="description"/>
    <meta content="programming,cryptography" name="keywords"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<div id="book" class="calibre1">
<h1 class="chapter" id="12">Chapter 12 <br class="calibre3"/>
Data Encryption Standard (DES)</h1>

<h3 id="12.1" class="calibre7">12.1 Background</h3>

<p class="calibre9">The Data Encryption Standard (DES), known as the Data Encryption
Algorithm (DEA) by ANSI and the DEA-1 by the ISO, has been a worldwide
standard for 20 years. Although it is showing signs of old age, it has held up
remarkably well against years of cryptanalysis and is still secure against all but
possibly the most powerful of adversaries.</p>

<h4 class="calibre8">Development of the Standard</h4>

<p class="calibre9">In the early 1970s, nonmilitary cryptographic research was haphazard. Almost
no research papers were published in the field. Most people knew that the
military used special coding equipment to communicate, but few understood
the science of cryptography. The National Security Agency (NSA) had
considerable knowledge, but they did not even publicly admit their own
existence.</p>

<p class="calibre9">Buyers didn’t know what they were buying. Several small companies made
and sold cryptographic equipment, primarily to overseas governments. The
equipment was all different and couldn’t interoperate. No one really knew if
any of it was secure; there was no independent body to certify the security. As
one government report said [<a href="Applied%20Cryptography_split_035.html#r441" class="calibre5 pcalibre">441</a>]:</p>

<p class="quote">The intricacies of relating key variations and working principles
to the real strength of the encryption/decryption equipment were,
and are, virtually unknown to almost all buyers, and informed
decisions as to the right type of on-line, off-line, key generation,
etc., which will meet buyers’ security needs, have been most
difficult to make.</p>

<p class="calibre9">In 1972, the National Bureau of Standards (NBS), now the National Institute
of Standards and Technology (NIST), initiated a program to protect computer
and communications data. As part of that program, they wanted to develop a
single, standard cryptographic algorithm. A single algorithm could be tested
and certified, and different cryptographic equipment using it could
interoperate. It would also be cheaper to implement and readily available.</p>

<p class="calibre9">In the May 15, 1973 <i class="calibre12">Federal Register, </i> the NBS issued a public request for
proposals for a standard cryptographic algorithm. They specified a series of
design criteria:</p>

<ul class="calibre13">

<li class="calibre14">The algorithm must provide a high level of security.
</li>
<li class="calibre14">The algorithm must be completely specified and easy to understand.
</li>
<li class="calibre14">The security of the algorithm must reside in the key; the security
should not depend on the secrecy of the algorithm.
</li>
<li class="calibre14">The algorithm must be available to all users.
</li>
<li class="calibre14">The algorithm must be adaptable for use in diverse applications.
</li>
<li class="calibre14">The algorithm must be economically implementable in electronic
devices.
</li>
<li class="calibre14">The algorithm must be efficient to use.
</li>
<li class="calibre14">The algorithm must be able to be validated.
</li>
<li class="calibre14">The algorithm must be exportable.
</li>

</ul>

<p class="calibre9">Public response indicated that there was considerable interest in a
cryptographic standard, but little public expertise in the field. None of the
submissions came close to meeting the requirements.</p>

<p class="calibre9">The NBS issued a second request in the August 27, 1974 <i class="calibre12">Federal Register. </i>
Eventually they received a promising candidate: an algorithm based on one
developed by IBM during the early 1970s, called Lucifer (see <a href="Applied%20Cryptography_split_016.html#13.1" class="calibre5 pcalibre">Section 13.1</a>).
IBM had a team working on cryptography at both Kingston and Yorktown
Heights, including Roy Adler, Don Coppersmith, Horst Feistel, Edna
Grossman, Alan Konheim, Carl Meyer, Bill Notz, Lynn Smith, Walt
Tuchman, and Bryant Tuckerman.</p>

<p class="calibre9">The algorithm, although complicated, was straightforward. It used only simple
logical operations on small groups of bits and could be implemented fairly
efficiently in hardware.</p>

<p class="calibre9">The NBS requested the NSA’s help in evaluating the algorithm’s security and
determining its suitability as a federal standard. IBM had already filed for a
patent [<a href="Applied%20Cryptography_split_035.html#r514" class="calibre5 pcalibre">514</a>], but was willing to make its intellectual property available to
others for manufacture, implementation, and use. Eventually, the NBS worked
out the terms of agreement with IBM and received a nonexclusive, royalty-free
license to make, use, and sell equipment that implemented the algorithm.</p>

<p class="calibre9">Finally, in the March 17, 1975 <i class="calibre12">Federal Register, </i> the NBS published both the
details of the algorithm and IBM’s statement granting a nonexclusive,
royalty-free license for the algorithm, and requested comment [<a href="Applied%20Cryptography_split_035.html#r536" class="calibre5 pcalibre">536</a>]. Another
notice, in the August 1, 1975 <i class="calibre12">Federal Register, </i> again requested comments
from agencies and the general public.</p>

<p class="calibre9">And there were comments [<a href="Applied%20Cryptography_split_035.html#r721" class="calibre5 pcalibre">721</a>,<a href="Applied%20Cryptography_split_035.html#r497" class="calibre5 pcalibre">497</a>,<a href="Applied%20Cryptography_split_036.html#r1120" class="calibre5 pcalibre">1120</a>]. Many were wary of the NSA’s
“invisible hand” in the development of the algorithm. They were afraid that the
NSA had modified the algorithm to install a trapdoor. They complained that
the NSA reduced the key size from the original 128-bits to 56-bits (see <a href="Applied%20Cryptography_split_016.html#13.1" class="calibre5 pcalibre">Section 13.1</a>). 
They complained about the inner workings of the algorithm. Much of
NSA’s reasoning became clear in the early 1990s, but in the 1970s this seemed
mysterious and worrisome.</p>

<p class="calibre9">In 1976, the NBS held two workshops to evaluate the proposed standard. The
first workshop discussed the mathematics of the algorithm and the possibility
of a trapdoor [<a href="Applied%20Cryptography_split_036.html#r1139" class="calibre5 pcalibre">1139</a>]. The second workshop discussed the possibility of
increasing the algorithm’s key length [<a href="Applied%20Cryptography_split_035.html#r229" class="calibre5 pcalibre">229</a>]. The algorithm’s designers,
evaluators, implementors, vendors, users, and critics were invited. From all
reports, the workshops were lively [<a href="Applied%20Cryptography_split_036.html#r1118" class="calibre5 pcalibre">1118</a>].</p>

<p class="calibre9">Despite criticism, the Data Encryption Standard was adopted as a federal
standard on November 23, 1976 [<a href="Applied%20Cryptography_split_035.html#r229" class="calibre5 pcalibre">229</a>] and authorized for use on all
unclassified government communications. The official description of the
standard, FIPS PUB 46, “Data Encryption Standard,” was published on
January 15, 1977 and became effective six months later [<a href="Applied%20Cryptography_split_036.html#r1140" class="calibre5 pcalibre">1140</a>]. FIPS PUB 81,
“DES Modes of Operation,” was published in 1980 [<a href="Applied%20Cryptography_split_036.html#r1143" class="calibre5 pcalibre">1143</a>]. FIPS PUB 74,
“Guidelines for Implementing and Using the NBS Data Encryption Standard,”
was published in 1981 [<a href="Applied%20Cryptography_split_036.html#r1142" class="calibre5 pcalibre">1142</a>]. NBS also published FIPS PUB 112, specifying
DES for password encryption [<a href="Applied%20Cryptography_split_036.html#r1144" class="calibre5 pcalibre">1144</a>], and FIPS PUB 113, specifying DES for
computer data authentication [<a href="Applied%20Cryptography_split_036.html#r1145" class="calibre5 pcalibre">1145</a>]. (FIPS stands for Federal Information
Processing Standard.)</p>

<p class="calibre9">These standards were unprecedented. Never before had an NSA-evaluated
algorithm been made public. This was probably the result of a
misunderstanding between NSA and NBS. The NSA thought DES was
hardware-only. The standard mandated a hardware implementation, but NBS
published enough details so that people could write DES software. Off the
record, NSA has characterized DES as one of their biggest mistakes. If they
knew the details would be released so that people could write software, they
would never have agreed to it. DES did more to galvanize the field of
cryptanalysis than anything else. Now there was an algorithm to study: one
that the NSA said was secure. It is no accident that the next government
standard algorithm, Skipjack (see <a href="Applied%20Cryptography_split_016.html#13.12" class="calibre5 pcalibre">Section 13.12</a>), was classified.</p>

<h4 class="calibre8">Adoption of the Standard</h4>

<p class="calibre9">The American National Standards Institute (ANSI) approved DES as a
private-sector standard in 1981 (ANSI X3.92) [<a href="Applied%20Cryptography_split_035.html#r50" class="calibre5 pcalibre">50</a>]. They called it the Data
Encryption Algorithm (DEA). ANSI published a standard for DEA modes of
operation (ANSI X3.106) [<a href="Applied%20Cryptography_split_035.html#r52" class="calibre5 pcalibre">52</a>], similar to the NBS document, and a standard
for network encryption that uses DES (ANSI X3.105) [<a href="Applied%20Cryptography_split_035.html#r51" class="calibre5 pcalibre">51</a>].</p>

<p class="calibre9">Two other groups within ANSI, representing retail and wholesale banking,
developed DES-based standards. Retail banking involves transactions between
financial institutions and private individuals, and wholesale banking involves
transactions between financial institutions.</p>

<p class="calibre9">ANSI’s Financial Institution Retail Security Working Group developed a
standard for the management and security of PINs (ANSI X9.8) [<a href="Applied%20Cryptography_split_035.html#r53" class="calibre5 pcalibre">53</a>] and
another DES-based standard for the authentication of retail financial messages
(ANSI X9.19) [<a href="Applied%20Cryptography_split_035.html#r56" class="calibre5 pcalibre">56</a>]. The group has a draft standard for secure key distribution
(ANSI X9.24) [<a href="Applied%20Cryptography_split_035.html#r58" class="calibre5 pcalibre">58</a>].</p>

<p class="calibre9">ANSI’s Financial Institution Wholesale Security Working Group developed its
own set of standards for message authentication (ANSI X9.9) [<a href="Applied%20Cryptography_split_035.html#r54" class="calibre5 pcalibre">54</a>], key
management (ANSI X9.17) [<a href="Applied%20Cryptography_split_035.html#r55" class="calibre5 pcalibre">55</a>,<a href="Applied%20Cryptography_split_036.html#r1151" class="calibre5 pcalibre">1151</a>], encryption (ANSI X9.23) [<a href="Applied%20Cryptography_split_035.html#r57" class="calibre5 pcalibre">57</a>], and
secure personal and node authentication (ANSI X9.26) [<a href="Applied%20Cryptography_split_035.html#r59" class="calibre5 pcalibre">59</a>].</p>

<p class="calibre9">The American Bankers Association develops voluntary standards for the
financial industry. They published a standard recommending DES for
encryption [<a href="Applied%20Cryptography_split_035.html#r1" class="calibre5 pcalibre">1</a>], and another standard for managing cryptographic keys [<a href="Applied%20Cryptography_split_035.html#r2" class="calibre5 pcalibre">2</a>].</p>

<p class="calibre9">Before the Computer Security Act of 1987, the General Services
Administration (GSA) was responsible for developing federal
telecommunications standards. Since then, that responsibility transferred to
NIST. The GSA published three standards that used DES: two for general
security and interoperability requirements (Federal Standard 1026 [<a href="Applied%20Cryptography_split_035.html#r662" class="calibre5 pcalibre">662</a>] and
Federal Standard 1027 [<a href="Applied%20Cryptography_split_035.html#r663" class="calibre5 pcalibre">663</a>]), and one for Group 3 facsimile equipment
(Federal Standard 1028) [<a href="Applied%20Cryptography_split_035.html#r664" class="calibre5 pcalibre">664</a>].</p>

<p class="calibre9">The Department of the Treasury wrote policy directives requiring that all
electronic-funds transfer messages be authenticated with DES [<a href="Applied%20Cryptography_split_035.html#r468" class="calibre5 pcalibre">468</a>,<a href="Applied%20Cryptography_split_035.html#r470" class="calibre5 pcalibre">470</a>]. They
also wrote DES-based criteria that all authentication devices must meet [<a href="Applied%20Cryptography_split_035.html#r469" class="calibre5 pcalibre">469</a>].</p>

<p class="calibre9">The ISO first voted to approve DES — they called it the DEA-1 — as an
international standard, then decided not to play a role in the standardization of
cryptography. However, in 1987 the International Wholesale Financial
Standards group of ISO used DES in an international authentication standard
[<a href="Applied%20Cryptography_split_035.html#r758" class="calibre5 pcalibre">758</a>] and for key management [<a href="Applied%20Cryptography_split_035.html#r761" class="calibre5 pcalibre">761</a>]. DES is also specified in an Australian
banking standard [<a href="Applied%20Cryptography_split_036.html#r1497" class="calibre5 pcalibre">1497</a>].</p>

<h4 class="calibre8">Validation and Certification of DES Equipment</h4>

<p class="calibre9">As part of the DES standard, NIST validates implementations of DES. This
validation confirms that the implementation follows the standard. Until 1994,
NIST only validated hardware and firmware implementations — until then the
standard prohibited software implementations. As of March 1995, 73 different
implementations had been validated.</p>

<p class="calibre9">NIST also developed a program to certify that authentication equipment
conformed to ANSI X9.9 and FIPS 113. As of March, 1995, 33 products had
been validated. The Department of the Treasury has an additional certification
procedure. NIST also has a program to confirm that equipment conforms to
ANSI X9.17 for wholesale key management [<a href="Applied%20Cryptography_split_036.html#r1151" class="calibre5 pcalibre">1151</a>]; four products have been
validated as of March, 1995.</p>

<h4 class="calibre8">1987</h4>

<p class="calibre9">The terms of the DES standard stipulate that it be reviewed every five years. In
1983 DES was recertified without a hitch. In the March 6, 1987 <i class="calibre12">Federal Register</i>, 
NBS published a request for comments on the second five-year
review. NBS offered three alternatives for consideration [<a href="Applied%20Cryptography_split_036.html#r1480" class="calibre5 pcalibre">1480</a>,<a href="Applied%20Cryptography_split_036.html#r1481" class="calibre5 pcalibre">1481</a>]: reaffirm
the standard for another five years, withdraw the standard, or revise the
applicability of the standard.</p>

<p class="calibre9">NBS and NSA reviewed the standard. NSA was more involved this time.
Because of an executive directive called NSDD-145, signed by Reagan, NSA
had veto power over the NBS in matters of cryptography. Initially, the NSA
announced that it would not recertify the standard. The problem was not that
DES had been broken, or even that it was suspected of having been broken. It
was simply increasingly likely that it would soon be broken.</p>

<p class="calibre9">In its place, the NSA proposed the Commercial COMSEC Endorsement
Program (CCEP), which would eventually provide a series of algorithms to
replace DES [<a href="Applied%20Cryptography_split_035.html#r85" class="calibre5 pcalibre">85</a>]. These NSA-designed algorithms would not be made public,
and would only be available in tamper-proof VLSI chips (see <a href="Applied%20Cryptography_split_029.html#25.1" class="calibre5 pcalibre">Section 25.1</a>).</p>

<p class="calibre9">This announcement wasn’t well received. People pointed out that business
(especially the financial industry) uses DES extensively, and that no adequate
alternative is available. Withdrawal of the standard would leave many
organizations with no data protection. After much debate, DES was reaffirmed
as a U.S. government standard until 1992 [<a href="Applied%20Cryptography_split_036.html#r1141" class="calibre5 pcalibre">1141</a>]. According to the NBS, DES
would not be certified again [<a href="Applied%20Cryptography_split_036.html#r1480" class="calibre5 pcalibre">1480</a>].</p>

<h4 class="calibre8">1993</h4>

<p class="calibre9">Never say “not.” In 1992, there was still no alternative for DES. The NBS,
now called NIST, again solicited comments on DES in the <i class="calibre12">Federal Register</i>
[<a href="Applied%20Cryptography_split_035.html#r540" class="calibre5 pcalibre">540</a>]:</p>

<p class="quote">The purpose of this notice is to announce the review to assess the
continued adequacy of the standard to protect computer data.
Comments from industry and the public are invited on the
following alternatives for FIPS 46-1. The costs (impacts) and
benefits of these alternatives should be included in the comments:
</p><ul class="calibre13">

<li class="calibre14">Reaffirm the standard for another five (5) years. The
National Institute of Standards and Technology would
continue to validate equipment that implements the
standard. FIPS 46-1 would continue to be the only
approved method for protecting unclassified computer data.</li>
<li class="calibre14">Withdraw the standard. The National Institute of
Standards and Technology would no longer continue to
support the standard. Organizations could continue to
utilize existing equipment that implements the standard.
Other standards could be issued by NIST as a replacement
for the DES.</li>
<li class="calibre14">Revise the applicability and/or implementation
statements for the standard. Such revisions could include
changing the standard to allow the use of implementations
of the DES in software as well as hardware; to allow the
iterative use of the DES in specific applications; to allow
the use of alternative algorithms that are approved and
registered by NIST.
</li>

</ul>
<p class="calibre9"></p>

<p class="calibre9">The comment period closed on December 10, 1992. According to Raymond
Kammer, then the acting director of NIST [<a href="Applied%20Cryptography_split_035.html#r813" class="calibre5 pcalibre">813</a>]:</p>

<p class="quote">Last year, NIST formally solicited comments on the
recertification of DES. After reviewing those comments, and the
other technical inputs that I have received, I plan to recommend to
the Secretary of Commerce that he recertify DES for another five
years. I also plan to suggest to the Secretary that when we
announce the recertification we state our intention to consider
alternatives to it over the next five years. By putting that
announcement on the table, we hope to give people an
opportunity to comment on orderly technological transitions. In
the meantime, we need to consider the large installed base of
systems that rely upon this proven standard.</p>

<p class="calibre9">Even though the Office of Technology Assessment quoted NIST’s Dennis
Branstead as saying that the useful lifetime of DES would end in the late 1990s
[<a href="Applied%20Cryptography_split_036.html#r1191" class="calibre5 pcalibre">1191</a>], the algorithm was recertified for another five years [<a href="Applied%20Cryptography_split_036.html#r1150" class="calibre5 pcalibre">1150</a>]. Software
implementations of DES were finally allowed to be certified.</p>

<p class="calibre9">Anyone want to guess what will happen in 1998?</p>

<h3 id="12.2" class="calibre7">12.2 Description of DES</h3>

<p class="calibre9">DES is a block cipher; it encrypts data in 64-bit blocks. A 64-bit block of
plaintext goes in one end of the algorithm and a 64-bit block of ciphertext
comes out the other end. DES is a symmetric algorithm: The same algorithm
and key are used for both encryption and decryption (except for minor
differences in the key schedule).</p>

<p class="calibre9">The key length is 56 bits. (The key is usually expressed as a 64-bit number, but
every eighth bit is used for parity checking and is ignored. These parity bits are
the least-significant bits of the key bytes.) The key can be any 56-bit number
and can be changed at any time. A handful of numbers are considered weak
keys, but they can easily be avoided. All security rests within the key.</p>

<p class="calibre9">At its simplest level, the algorithm is nothing more than a combination of the
two basic techniques of encryption: confusion and diffusion. The fundamental
building block of DES is a single combination of these techniques (a
substitution followed by a permutation) on the text, based on the key. This is
known as a <b class="calibre10">round</b>. DES has 16 rounds; it applies the same combination of
techniques on the plaintext block 16 times (see Figure 12.1).</p>

<div class="figure" id="figure-12-1">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-1.png" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.1</b> DES.</i></p>
</div>

<p class="calibre9">The algorithm uses only standard arithmetic and logical operations on numbers
of 64 bits at most, so it was easily implemented in late 1970s hardware
technology. The repetitive nature of the algorithm makes it ideal for use on a
special-purpose chip. Initial software implementations were clumsy, but
current implementations are better.</p>

<h4 class="calibre8">Outline of the Algorithm</h4>

<p class="calibre9">DES operates on a 64-bit block of plaintext. After an initial permutation, the
block is broken into a right half and a left half, each 32 bits long. Then there
are 16 rounds of identical operations, called Function <i class="calibre12">f</i>, in which the data are
combined with the key. After the sixteenth round, the right and left halves are
joined, and a final permutation (the inverse of the initial permutation) finishes
off the algorithm.</p>

<p class="calibre9">In each round (see Figure 12.2), the key bits are shifted, and then 48 bits are
selected from the 56 bits of the key. The right half of the data is expanded to
48 bits via an expansion permutation, combined with 48 bits of a shifted and
permuted key via an XOR, sent through 8 S-boxes producing 32 new bits, and
permuted again. These four operations make up Function <i class="calibre12">f</i>. The output of
Function <i class="calibre12">f</i> is then combined with the left half via another XOR. The result of
these operations becomes the new right half; the old right half becomes the
new left half. These operations are repeated 16 times, making 16 rounds of
DES.</p>

<div class="figure" id="figure-12-2">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-2.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.2</b> One round of DES.</i></p>
</div>

<p class="calibre9">If <i class="calibre12">B</i><sub class="calibre15">i</sub> is the result of the <i class="calibre12">i</i>th iteration, <i class="calibre12">L</i><sub class="calibre15">i</sub> and <i class="calibre12">R</i><sub class="calibre15">i</sub> are the left and right halves of <i class="calibre12">B</i><sub class="calibre15">i</sub>, <i class="calibre12">K</i><sub class="calibre15">i</sub> is the 48-bit key for round <i class="calibre12">i, </i> and <i class="calibre12">f</i> is the function that does all the substituting and permuting and XORing with the key, then a round looks like:</p>

<p class="math"><i class="calibre12">L</i><sub class="calibre15">i</sub> = <i class="calibre12">R</i><sub class="calibre15">i-1</sub>
<i class="calibre12">R</i><sub class="calibre15">i</sub> = <i class="calibre12">L</i><sub class="calibre15">i-1</sub> ⊕ <i class="calibre12">f</i>(<i class="calibre12">R</i><sub class="calibre15">i-1</sub>, <i class="calibre12">K</i><sub class="calibre15">i</sub>)
</p>

<h4 class="calibre8">The Initial Permutation</h4>

<p class="calibre9">The initial permutation occurs before round 1; it transposes the input block as
described in Table 12.1. This table, like all the other tables in this chapter,
should be read left to right, top to bottom. For example, the initial permutation
moves bit 58 of the plaintext to bit position 1, bit 50 to bit position 2, bit 42 to
bit position 3, and so forth.</p>

<table class="data-table1" id="table-12-1">
<caption class="calibre67">Table 12.1 - Initial Permutation</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre69">58</td><td class="calibre69">50</td><td class="calibre69">42</td><td class="calibre69">34</td><td class="calibre69">26</td><td class="calibre69">18</td><td class="calibre69">10</td><td class="calibre69">2</td><td class="calibre69">60</td><td class="calibre69">52</td><td class="calibre69">44</td><td class="calibre69">36</td><td class="calibre69">28</td><td class="calibre69">20</td><td class="calibre69">12</td><td class="calibre69">4</td></tr>
<tr class="calibre25"><td class="calibre70">62</td><td class="calibre70">54</td><td class="calibre70">46</td><td class="calibre70">38</td><td class="calibre70">30</td><td class="calibre70">22</td><td class="calibre70">14</td><td class="calibre70">6</td><td class="calibre70">64</td><td class="calibre70">56</td><td class="calibre70">48</td><td class="calibre70">40</td><td class="calibre70">32</td><td class="calibre70">24</td><td class="calibre70">16</td><td class="calibre70">8</td></tr>
<tr class="calibre71"><td class="calibre72">57</td><td class="calibre72">49</td><td class="calibre72">41</td><td class="calibre72">33</td><td class="calibre72">25</td><td class="calibre72">17</td><td class="calibre72">9</td><td class="calibre72">1</td><td class="calibre72">59</td><td class="calibre72">51</td><td class="calibre72">43</td><td class="calibre72">35</td><td class="calibre72">27</td><td class="calibre72">19</td><td class="calibre72">11</td><td class="calibre72">3</td></tr>
<tr class="calibre25"><td class="calibre70">61</td><td class="calibre70">53</td><td class="calibre70">45</td><td class="calibre70">37</td><td class="calibre70">29</td><td class="calibre70">21</td><td class="calibre70">13</td><td class="calibre70">5</td><td class="calibre70">63</td><td class="calibre70">55</td><td class="calibre70">47</td><td class="calibre70">39</td><td class="calibre70">31</td><td class="calibre70">23</td><td class="calibre70">15</td><td class="calibre70">7</td></tr>
</tbody></table>

<p class="calibre39">The initial permutation and the corresponding final permutation do not affect
DES’s security. (As near as anyone can tell, its primary purpose is to make it
easier to load plaintext and ciphertext data into a DES chip in byte-sized
pieces. Remember that DES predates 16-bit or 32-bit microprocessor busses.)
Since this bit-wise permutation is difficult in software (although it is trivial in
hardware), many software implementations of DES leave out both the initial
and final permutations. While this new algorithm is no less secure than DES, it
does not follow the DES standard and should not be called DES.</p>

<h4 class="calibre8">The Key Transformation</h4>

<p class="calibre9">Initially, the 64-bit DES key is reduced to a 56-bit key by ignoring every
eighth bit. This is described in Table 12.2. These bits can be used as parity
check to ensure the key is error-free. After the 56-bit key is extracted, a
different 48-bit <b class="calibre10">subkey</b> is generated for each of the 16 rounds of DES. These
subkeys, <i class="calibre12">K<sub class="calibre15">i</sub></i> are determined in the following manner.</p>


<table class="data-table1" id="table-12-2">
<caption class="calibre67">Table 12.2 - Key Permutation</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre69">57</td><td class="calibre69">49</td><td class="calibre69">41</td><td class="calibre69">33</td><td class="calibre69">25</td><td class="calibre69">17</td><td class="calibre69">9</td><td class="calibre69">1</td><td class="calibre69">58</td><td class="calibre69">50</td><td class="calibre69">42</td><td class="calibre69">34</td><td class="calibre69">26</td><td class="calibre69">18</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">2</td><td class="calibre70">59</td><td class="calibre70">51</td><td class="calibre70">43</td><td class="calibre70">35</td><td class="calibre70">27</td><td class="calibre70">19</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">60</td><td class="calibre70">52</td><td class="calibre70">44</td><td class="calibre70">36</td></tr>
<tr class="calibre71"><td class="calibre72">63</td><td class="calibre72">55</td><td class="calibre72">47</td><td class="calibre72">39</td><td class="calibre72">31</td><td class="calibre72">23</td><td class="calibre72">15</td><td class="calibre72">7</td><td class="calibre72">62</td><td class="calibre72">54</td><td class="calibre72">46</td><td class="calibre72">38</td><td class="calibre72">30</td><td class="calibre72">22</td></tr>
<tr class="calibre25"><td class="calibre70">14</td><td class="calibre70">6</td><td class="calibre70">61</td><td class="calibre70">53</td><td class="calibre70">45</td><td class="calibre70">37</td><td class="calibre70">29</td><td class="calibre70">21</td><td class="calibre70">13</td><td class="calibre70">5</td><td class="calibre70">28</td><td class="calibre70">20</td><td class="calibre70">12</td><td class="calibre70">4</td></tr>
</tbody></table>

<p class="calibre39">First, the 56-bit key is divided into two 28-bit halves. Then, the halves are
circularly shifted left by either one or two bits, depending on the round. This
shift is given in Table 12.3.</p>

<table class="data-table1" id="table-12-3">
<caption class="calibre67">Table 12.3 - Number of Key Bits Shifted per Round</caption>
<tbody class="calibre24"><tr class="calibre73"><td class="calibre74">Round</td><td class="calibre75">1</td><td class="calibre75">2</td><td class="calibre75">3</td><td class="calibre75">4</td><td class="calibre75">5</td><td class="calibre75">6</td><td class="calibre75">7</td><td class="calibre75">8</td><td class="calibre75">9</td><td class="calibre75">10</td><td class="calibre75">11</td><td class="calibre75">12</td><td class="calibre75">13</td><td class="calibre75">14</td><td class="calibre75">15</td><td class="calibre75">16</td></tr>
<tr class="calibre25"><td class="calibre76">Number</td><td class="calibre70">1</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">2</td><td class="calibre70">1</td></tr>
</tbody></table>

<p class="calibre39">After being shifted, 48 out of the 56 bits are selected. Because this operation
permutes the order of the bits as well as selects a subset of bits, it is called a
<b class="calibre10">compression permutation</b>. This operation provides a subset of 48 bits. Table
12.4 defines the compression permutation (also called the permuted choice).
For example, the bit in position 33 of the shifted key moves to position 35 of
the output, and the bit in position 18 of the shifted key is ignored.</p>

<table class="data-table1" id="table-12-4">
<caption class="calibre67">Table 12.4 - Compression Permutation</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre69">14</td><td class="calibre69">17</td><td class="calibre69">11</td><td class="calibre69">24</td><td class="calibre69">1</td><td class="calibre69">5</td><td class="calibre69">3</td><td class="calibre69">28</td><td class="calibre69">15</td><td class="calibre69">6</td><td class="calibre69">21</td><td class="calibre69">10</td></tr>
<tr class="calibre25"><td class="calibre70">23</td><td class="calibre70">19</td><td class="calibre70">12</td><td class="calibre70">4</td><td class="calibre70">26</td><td class="calibre70">8</td><td class="calibre70">16</td><td class="calibre70">7</td><td class="calibre70">27</td><td class="calibre70">20</td><td class="calibre70">13</td><td class="calibre70">2</td></tr>
<tr class="calibre71"><td class="calibre72">41</td><td class="calibre72">52</td><td class="calibre72">31</td><td class="calibre72">37</td><td class="calibre72">47</td><td class="calibre72">55</td><td class="calibre72">30</td><td class="calibre72">40</td><td class="calibre72">51</td><td class="calibre72">45</td><td class="calibre72">33</td><td class="calibre72">48</td></tr>
<tr class="calibre25"><td class="calibre70">44</td><td class="calibre70">49</td><td class="calibre70">39</td><td class="calibre70">56</td><td class="calibre70">34</td><td class="calibre70">53</td><td class="calibre70">46</td><td class="calibre70">42</td><td class="calibre70">50</td><td class="calibre70">36</td><td class="calibre70">29</td><td class="calibre70">32</td></tr>
</tbody></table>

<p class="calibre39">Because of the shifting, a different subset of key bits is used in each subkey.
Each bit is used in approximately 14 of the 16 subkeys, although not all bits
are used exactly the same number of times.</p>

<h4 class="calibre8">The Expansion Permutation</h4>

<p class="calibre9">This operation expands the right half of the data, <i class="calibre12">R<sub class="calibre15">i</sub></i>, from 32 bits to 48 bits.
Because this operation changes the order of the bits as well as repeating certain
bits, it is known as an <b class="calibre10">expansion permutation</b>. This operation has two
purposes: It makes the right half the same size as the key for the XOR
operation and it provides a longer result that can be compressed during the
substitution operation. However, neither of those is its main cryptographic
purpose. By allowing one bit to affect two substitutions, the dependency of the
output bits on the input bits spreads faster. This is called an <b class="calibre10">avalanche effect</b>.
DES is designed to reach the condition of having every bit of the ciphertext
depend on every bit of the plaintext and every bit of the key as quickly as
possible.</p>

<p class="calibre9">Figure 12.3 defines the expansion permutation. This is sometimes called the
<b class="calibre10">E-box</b>. For each 4-bit input block, the first and fourth bits each represent two bits of the output block, while the second and third bits each represent one bit
of the output block. Table 12.5 shows which output positions correspond to
which input positions. For example, the bit in position 3 of the input block
moves to position 4 of the output block, and the bit in position 21 of the input
block moves to positions 30 and 32 of the output block.
Although the output block is larger than the input block, each input block
generates a unique output block.</p>

<div class="figure" id="figure-12-3">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-3.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.3</b> Expansion permutation.</i></p>
</div>

<table class="data-table1" id="table-12-5">
<caption class="calibre67">Table 12.5 - Expansion Permutation</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre69">32</td><td class="calibre69">1</td><td class="calibre69">2</td><td class="calibre69">3</td><td class="calibre69">4</td><td class="calibre69">5</td><td class="calibre69">4</td><td class="calibre69">5</td><td class="calibre69">6</td><td class="calibre69">7</td><td class="calibre69">8</td><td class="calibre69">9</td></tr>
<tr class="calibre25"><td class="calibre70">8</td><td class="calibre70">9</td><td class="calibre70">10</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">13</td><td class="calibre70">12</td><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">15</td><td class="calibre70">16</td><td class="calibre70">17</td></tr>
<tr class="calibre71"><td class="calibre72">16</td><td class="calibre72">17</td><td class="calibre72">18</td><td class="calibre72">19</td><td class="calibre72">20</td><td class="calibre72">21</td><td class="calibre72">20</td><td class="calibre72">21</td><td class="calibre72">22</td><td class="calibre72">23</td><td class="calibre72">24</td><td class="calibre72">25</td></tr>
<tr class="calibre25"><td class="calibre70">24</td><td class="calibre70">25</td><td class="calibre70">26</td><td class="calibre70">27</td><td class="calibre70">28</td><td class="calibre70">29</td><td class="calibre70">28</td><td class="calibre70">29</td><td class="calibre70">30</td><td class="calibre70">31</td><td class="calibre70">32</td><td class="calibre70">1</td></tr>
</tbody></table>

<h4 class="calibre8">The S-Box Substitution</h4>

<p class="calibre9">After the compressed key is XORed with the expanded block, the 48-bit result
moves to a substitution operation. The substitutions are performed by eight
<b class="calibre10">substitution boxes, </b> or <b class="calibre10">S-boxes</b>. Each S-box has a 6-bit input and a 4-bit output, and there are eight different S-boxes. (The total memory requirement
for the eight DES S-boxes is 256 bytes.) The 48 bits are divided into eight
6-bit sub-blocks. Each separate block is operated on by a separate S-box: The
first block is operated on by S-box 1, the second block is operated on by S-box
2, and so on. See Figure 12.4.</p>

<div class="figure" id="figure-12-4">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-4.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.4</b> S-box substitution.</i></p>
</div>

<p class="calibre9">Each S-box is a table of 4 rows and 16 columns. Each entry in the box is a
4-bit number. The 6 input bits of the S-box specify under which row and
column number to look for the output. Table 12.6 shows all eight S-boxes.</p>

<table class="data-table1" id="table-12-6">
<caption class="calibre67">Table 12.6 - S-Boxes</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="title3" colspan="16">S-box 1:</td></tr>
<tr class="calibre25"><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">15</td><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">7</td></tr>
<tr class="calibre25"><td class="calibre70">0</td><td class="calibre70">15</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">12</td><td class="calibre70">11</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">1</td><td class="calibre70">14</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">6</td><td class="calibre70">2</td><td class="calibre70">11</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">7</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">5</td><td class="calibre70">0</td></tr>
<tr class="calibre25"><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">8</td><td class="calibre70">2</td><td class="calibre70">4</td><td class="calibre70">9</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">5</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 2:</td></tr>
<tr class="calibre25"><td class="calibre70">15</td><td class="calibre70">1</td><td class="calibre70">8</td><td class="calibre70">14</td><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">4</td><td class="calibre70">9</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">13</td><td class="calibre70">12</td><td class="calibre70">0</td><td class="calibre70">5</td><td class="calibre70">10</td></tr>
<tr class="calibre25"><td class="calibre70">3</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">7</td><td class="calibre70">15</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">14</td><td class="calibre70">12</td><td class="calibre70">0</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">11</td><td class="calibre70">5</td></tr>
<tr class="calibre25"><td class="calibre70">0</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">11</td><td class="calibre70">10</td><td class="calibre70">4</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">5</td><td class="calibre70">8</td><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">2</td><td class="calibre70">15</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">10</td><td class="calibre70">1</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">11</td><td class="calibre70">6</td><td class="calibre70">7</td><td class="calibre70">12</td><td class="calibre70">0</td><td class="calibre70">5</td><td class="calibre70">14</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 3:</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">9</td><td class="calibre70">14</td><td class="calibre70">6</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">5</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">12</td><td class="calibre70">7</td><td class="calibre70">11</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">7</td><td class="calibre70">0</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">4</td><td class="calibre70">6</td><td class="calibre70">10</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">5</td><td class="calibre70">14</td><td class="calibre70">12</td><td class="calibre70">11</td><td class="calibre70">15</td><td class="calibre70">1</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">6</td><td class="calibre70">4</td><td class="calibre70">9</td><td class="calibre70">8</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">14</td><td class="calibre70">7</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">13</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">8</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">15</td><td class="calibre70">14</td><td class="calibre70">3</td><td class="calibre70">11</td><td class="calibre70">5</td><td class="calibre70">2</td><td class="calibre70">12</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 4:</td></tr>
<tr class="calibre25"><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">10</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">5</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">4</td><td class="calibre70">15</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">11</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">4</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">14</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">12</td><td class="calibre70">11</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">15</td><td class="calibre70">1</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">5</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">4</td></tr>
<tr class="calibre25"><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">10</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">9</td><td class="calibre70">4</td><td class="calibre70">5</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">14</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 5:</td></tr>
<tr class="calibre25"><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">4</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">10</td><td class="calibre70">11</td><td class="calibre70">6</td><td class="calibre70">8</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">13</td><td class="calibre70">0</td><td class="calibre70">14</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="calibre70">14</td><td class="calibre70">11</td><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">4</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">15</td><td class="calibre70">10</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">8</td><td class="calibre70">6</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">1</td><td class="calibre70">11</td><td class="calibre70">10</td><td class="calibre70">13</td><td class="calibre70">7</td><td class="calibre70">8</td><td class="calibre70">15</td><td class="calibre70">9</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">14</td></tr>
<tr class="calibre25"><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">12</td><td class="calibre70">7</td><td class="calibre70">1</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">13</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">9</td><td class="calibre70">10</td><td class="calibre70">4</td><td class="calibre70">5</td><td class="calibre70">3</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 6:</td></tr>
<tr class="calibre25"><td class="calibre70">12</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">9</td><td class="calibre70">2</td><td class="calibre70">6</td><td class="calibre70">8</td><td class="calibre70">0</td><td class="calibre70">13</td><td class="calibre70">3</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">5</td><td class="calibre70">11</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">7</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">0</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">9</td><td class="calibre70">14</td><td class="calibre70">15</td><td class="calibre70">5</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">12</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">0</td><td class="calibre70">4</td><td class="calibre70">10</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">11</td><td class="calibre70">6</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">3</td><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">15</td><td class="calibre70">10</td><td class="calibre70">11</td><td class="calibre70">14</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">6</td><td class="calibre70">0</td><td class="calibre70">8</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 7:</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">11</td><td class="calibre70">2</td><td class="calibre70">14</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">3</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">7</td><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">1</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">0</td><td class="calibre70">11</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">9</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">14</td><td class="calibre70">3</td><td class="calibre70">5</td><td class="calibre70">12</td><td class="calibre70">2</td><td class="calibre70">15</td><td class="calibre70">8</td><td class="calibre70">6</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">4</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">12</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">14</td><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">6</td><td class="calibre70">8</td><td class="calibre70">0</td><td class="calibre70">5</td><td class="calibre70">9</td><td class="calibre70">2</td></tr>
<tr class="calibre25"><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">1</td><td class="calibre70">4</td><td class="calibre70">10</td><td class="calibre70">7</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">15</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">3</td><td class="calibre70">12</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 8:</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">4</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">12</td><td class="calibre70">7</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">15</td><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">10</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">0</td><td class="calibre70">14</td><td class="calibre70">9</td><td class="calibre70">2</td></tr>
<tr class="calibre71"><td class="calibre72">7</td><td class="calibre72">11</td><td class="calibre72">4</td><td class="calibre72">1</td><td class="calibre72">9</td><td class="calibre72">12</td><td class="calibre72">14</td><td class="calibre72">2</td><td class="calibre72">0</td><td class="calibre72">6</td><td class="calibre72">10</td><td class="calibre72">13</td><td class="calibre72">15</td><td class="calibre72">3</td><td class="calibre72">5</td><td class="calibre72">8</td></tr>
<tr class="calibre25"><td class="calibre70">2</td><td class="calibre70">1</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">10</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">11</td></tr>
</tbody></table>

<p class="calibre39">The input bits specify an entry in the S-box in a very particular manner.
Consider an S-box input of 6 bits, labeled <i class="calibre12">b</i><sub class="calibre15">1</sub> <i class="calibre12">b</i><sub class="calibre15">2</sub> <i class="calibre12">b</i><sub class="calibre15">3</sub> <i class="calibre12">b</i><sub class="calibre15">4</sub> <i class="calibre12">b</i><sub class="calibre15">5</sub> and <i class="calibre12">b</i><sub class="calibre15">6</sub>. Bits <i class="calibre12">b</i><sub class="calibre15">1</sub> and <i class="calibre12">b</i><sub class="calibre15">6</sub>
are combined to form a 2-bit number, from 0 to 3, which corresponds to a row
in the table. The middle 4 bits, <i class="calibre12">b</i><sub class="calibre15">2</sub> through <i class="calibre12">b</i><sub class="calibre15">5</sub> are combined to form a 4-bit number, from 0 to 15, which corresponds to a column in the table.</p>

<p class="calibre9">For example, assume that the input to the sixth S-box (i.e., bits 31 through 36
of the XOR function) is 110011. The first and last bits combine to form 11,
which corresponds to row 3 of the sixth S-box. The middle 4 bits combine to
form 1001, which corresponds to the column 9 of the same S-box. The entry
under row 3, column 9 of S-box 6 is 14. (Remember to count rows and
columns from 0 and not from 1.) The value 1110 is substituted for 110011.</p>

<p class="calibre9">It is, of course, far easier to implement the S-boxes in software as 64-entry
arrays. It takes some rearranging of the entries to do this, but that’s not hard.
(Don’t just change the indexing without rearranging the entries. The S-boxes
are designed very carefully.) However, this way of describing the S-boxes
helps visualize how they work. Each S-box can be viewed as a substitution
function on a 4-bit entry: <i class="calibre12">b</i><sub class="calibre15">2</sub> through <i class="calibre12">b</i><sub class="calibre15">5</sub> go in, and a 4-bit result comes out. Bits <i class="calibre12">b</i><sub class="calibre15">1</sub> and <i class="calibre12">b</i><sub class="calibre15">6</sub> come from neighboring blocks; they select one out of four
substitution functions available in the particular S-box.</p>

<p class="calibre9">The S-box substitution is the critical step in DES. The algorithm’s other
operations are linear and easy to analyze. The S-boxes are nonlinear and, more
than anything else, give DES its security.</p>

<p class="calibre9">The result of this substitution phase is eight 4-bit blocks which are recombined
into a single 32-bit block. This block moves to the next step: the P-box
permutation.</p>

<h4 class="calibre8">The P-Box Permutation</h4>

<p class="calibre9">The 32-bit output of the S-box substitution is permuted according to a <b class="calibre10">P-box</b>.
This permutation maps each input bit to an output position; no bits are used
twice and no bits are ignored. This is called a <b class="calibre10">straight permutation</b> or just a
permutation. Table 12.7 shows the position to which each bit moves. For
example, bit 21 moves to bit 4, while bit 4 moves to bit 31.</p>

<table class="data-table1" id="table-12-7">
<caption class="calibre67">Table 12.7 - P-Box Permutation</caption>
<tbody class="calibre24"><tr class="calibre73"><td class="calibre75">16</td><td class="calibre75">7</td><td class="calibre75">20</td><td class="calibre75">21</td><td class="calibre75">29</td><td class="calibre75">12</td><td class="calibre75">28</td><td class="calibre75">17</td><td class="calibre75">1</td><td class="calibre75">15</td><td class="calibre75">23</td><td class="calibre75">26</td><td class="calibre75">5</td><td class="calibre75">18</td><td class="calibre75">31</td><td class="calibre75">10</td></tr>
<tr class="calibre25"><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">24</td><td class="calibre70">14</td><td class="calibre70">32</td><td class="calibre70">27</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">19</td><td class="calibre70">13</td><td class="calibre70">30</td><td class="calibre70">6</td><td class="calibre70">22</td><td class="calibre70">11</td><td class="calibre70">4</td><td class="calibre70">25</td></tr>
</tbody></table>

<p class="calibre39">Finally, the result of the P-box permutation is XORed with the left half of the
initial 64-bit block. Then the left and right halves are switched and another
round begins.</p>

<h4 class="calibre8">The Final Permutation</h4>

<p class="calibre9">The final permutation is the inverse of the initial permutation and is described
in Table 12.8. Note that the left and right halves are not exchanged after the
last round of DES; instead the concatenated block <i class="calibre12">R</i><sub class="calibre15">16</sub><i class="calibre12">L</i><sub class="calibre15">16</sub> is used as the input to the final permutation. There’s nothing going on here; exchanging the halves
and shifting around the permutation would yield exactly the same result. This
is so that the algorithm can be used to both encrypt and decrypt.</p>

<table class="data-table1" id="table-12-8">
<caption class="calibre67">Table 12.8 - Final Permutation</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre69">40</td><td class="calibre69">8</td><td class="calibre69">48</td><td class="calibre69">16</td><td class="calibre69">56</td><td class="calibre69">24</td><td class="calibre69">64</td><td class="calibre69">32</td><td class="calibre69">39</td><td class="calibre69">7</td><td class="calibre69">47</td><td class="calibre69">15</td><td class="calibre69">55</td><td class="calibre69">23</td><td class="calibre69">63</td><td class="calibre69">31</td></tr>
<tr class="calibre25"><td class="calibre70">38</td><td class="calibre70">6</td><td class="calibre70">46</td><td class="calibre70">14</td><td class="calibre70">54</td><td class="calibre70">22</td><td class="calibre70">62</td><td class="calibre70">30</td><td class="calibre70">37</td><td class="calibre70">5</td><td class="calibre70">45</td><td class="calibre70">13</td><td class="calibre70">53</td><td class="calibre70">21</td><td class="calibre70">61</td><td class="calibre70">29</td></tr>
<tr class="calibre71"><td class="calibre72">36</td><td class="calibre72">4</td><td class="calibre72">44</td><td class="calibre72">12</td><td class="calibre72">52</td><td class="calibre72">20</td><td class="calibre72">60</td><td class="calibre72">28</td><td class="calibre72">35</td><td class="calibre72">3</td><td class="calibre72">43</td><td class="calibre72">11</td><td class="calibre72">51</td><td class="calibre72">19</td><td class="calibre72">59</td><td class="calibre72">27</td></tr>
<tr class="calibre25"><td class="calibre70">34</td><td class="calibre70">2</td><td class="calibre70">42</td><td class="calibre70">10</td><td class="calibre70">50</td><td class="calibre70">18</td><td class="calibre70">58</td><td class="calibre70">26</td><td class="calibre70">33</td><td class="calibre70">1</td><td class="calibre70">41</td><td class="calibre70">9</td><td class="calibre70">49</td><td class="calibre70">17</td><td class="calibre70">57</td><td class="calibre70">25</td></tr>
</tbody></table>

<h4 class="calibre8">Decrypting DES</h4>

<p class="calibre9">After all the substitutions, permutations, XORs, and shifting around, you
might think that the decryption algorithm is completely different and just as
confusing as the encryption algorithm. On the contrary, the various operations
were chosen to produce a very useful property: The same algorithm works for
both encryption and decryption.</p>

<p class="calibre9">With DES it is possible to use the same function to encrypt or decrypt a block.
The only difference is that the keys must be used in the reverse order. That is,
if the encryption keys for each round are <i class="calibre12">K</i><sub class="calibre15">1</sub> <i class="calibre12">K</i><sub class="calibre15">2</sub> <i class="calibre12">K</i><sub class="calibre15">3</sub>, ..., <i class="calibre12">K</i><sub class="calibre15">16</sub> then the decryption
keys are <i class="calibre12">K</i><sub class="calibre15">16</sub> <i class="calibre12">K</i><sub class="calibre15">15</sub> <i class="calibre12">K</i><sub class="calibre15">14</sub>, ..., <i class="calibre12">K</i><sub class="calibre15">1</sub>. 
The algorithm that generates the key used for each round is circular as well. The key shift is a right shift and the number of
positions shifted is 0,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1.</p>

<h4 class="calibre8">Modes of DES</h4>

<p class="calibre9">FIPS PUB 81 specifies four modes of operation: ECB, CBC, OFB, and CFB
(see <a href="Applied%20Cryptography_split_011.html#9" class="calibre5 pcalibre">Chapter 9</a>) [<a href="Applied%20Cryptography_split_036.html#r1143" class="calibre5 pcalibre">1143</a>]. The ANSI banking standards specify ECB and CBC
for encryption, and CBC and <i class="calibre12">n-</i>bit CFB for authentication [<a href="Applied%20Cryptography_split_035.html#r52" class="calibre5 pcalibre">52</a>].</p>

<p class="calibre9">In the software world, certification is usually not an issue. Because of its
simplicity, ECB is most often used in off-the-shelf commercial software
products, although it is the most vulnerable to attack. CBC is used
occasionally, even though it is just slightly more complicated than ECB and
provides much more security.</p>

<h4 class="calibre8">Hardware and Software Implementations of DES</h4>

<p class="calibre9">Much has been written on efficient hardware and software implementations of
the algorithm [<a href="Applied%20Cryptography_split_036.html#r997" class="calibre5 pcalibre">997</a>,<a href="Applied%20Cryptography_split_035.html#r81" class="calibre5 pcalibre">81</a>,<a href="Applied%20Cryptography_split_035.html#r533" class="calibre5 pcalibre">533</a>,<a href="Applied%20Cryptography_split_035.html#r534" class="calibre5 pcalibre">534</a>,<a href="Applied%20Cryptography_split_035.html#r437" class="calibre5 pcalibre">437</a>,<a href="Applied%20Cryptography_split_035.html#r738" class="calibre5 pcalibre">738</a>,<a href="Applied%20Cryptography_split_036.html#r1573" class="calibre5 pcalibre">1573</a>,<a href="Applied%20Cryptography_split_035.html#r176" class="calibre5 pcalibre">176</a>,<a href="Applied%20Cryptography_split_035.html#r271" class="calibre5 pcalibre">271</a>,<a href="Applied%20Cryptography_split_036.html#r1572" class="calibre5 pcalibre">1572</a>]. At this writing,
the recordholder for the fastest DES chip is a prototype developed at Digital
Equipment Corporation [<a href="Applied%20Cryptography_split_035.html#r512" class="calibre5 pcalibre">512</a>]. It supports ECB and CBC modes and is based
on a GaAs gate array of 50,000 transistors. Data can be encrypted and
decrypted at a rate of 1 gigabit per second, which translates to 16.8 million
blocks per second. This is impressive. Table 12.9 gives the specifications for
some commercial DES chips. Seeming discrepancies between clock speed and
data rate are due to pipelining within the chip; a chip might have multiple DES
engines working in parallel.</p>

<table class="data-table1" id="table-12-9">
<caption class="calibre67">Table 12.9 - Commercial DES Chips</caption>
<tbody class="calibre24"><tr class="calibre68">
<th class="calibre26">Manufacturer</th>
<th class="calibre26">Chip</th>
<th class="calibre26">Year</th>
<th class="calibre26">Clock</th>
<th class="calibre26">Data Rate</th>
<th class="calibre26">Availability</th>
</tr>
<tr class="calibre25"><td class="calibre61">AMD</td><td class="calibre61">Am9518</td><td class="calibre77">1981</td><td class="calibre77">3 MHz </td><td class="calibre77">1.3 MByte/s</td><td class="calibre77">N</td></tr>
<tr class="calibre25"><td class="calibre61">AMD</td><td class="calibre61">Am9568</td><td class="calibre77">?</td><td class="calibre77">4 MHz </td><td class="calibre77">1.5 MByte/s</td><td class="calibre77">N</td></tr>
<tr class="calibre25"><td class="calibre61">AMD</td><td class="calibre61">AmZ8068</td><td class="calibre77">1982</td><td class="calibre77">4 MHz </td><td class="calibre77">1.7 MByte/s</td><td class="calibre77">N</td></tr>
<tr class="calibre25"><td class="calibre61">AT&amp;T</td><td class="calibre61">T7000A</td><td class="calibre77">1985</td><td class="calibre77">?</td><td class="calibre77">1.9 MByte/s</td><td class="calibre77">N</td></tr>
<tr class="calibre25"><td class="calibre61">CE-Infosys</td><td class="calibre61">SuperCrypt CE99C003</td><td class="calibre77">1992</td><td class="calibre77">20 MHz</td><td class="calibre77">12.5 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">CE-Infosys</td><td class="calibre61">SuperCrypt CE99C003A</td><td class="calibre77">1994</td><td class="calibre77">30 MHz</td><td class="calibre77">20.0 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Cryptech</td><td class="calibre61">Cry12C102</td><td class="calibre77">1989</td><td class="calibre77">20 MHz </td><td class="calibre77">2.8 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Newbridge</td><td class="calibre61">CA20C03A</td><td class="calibre77">1991</td><td class="calibre77">25 MHz</td><td class="calibre77">3.85 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Newbridge</td><td class="calibre61">CA20C03W</td><td class="calibre77">1992</td><td class="calibre77">8 MHz</td><td class="calibre77">0.64 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Newbridge</td><td class="calibre61">CA95C68/18/09 </td><td class="calibre77">1993</td><td class="calibre77">33 MHz</td><td class="calibre77">14.67 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Pijnenburg</td><td class="calibre61">PCC100</td><td class="calibre77">?</td><td class="calibre77">?</td><td class="calibre77">2.5 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Semaphore Communications</td><td class="calibre61">Roadrunner284</td><td class="calibre77">?</td><td class="calibre77">40 MHz</td><td class="calibre77">35.5 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">VLSI Technology</td><td class="calibre61">VM007</td><td class="calibre77">1993</td><td class="calibre77">32 MHz</td><td class="calibre77">20.0 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre25"><td class="calibre61">VLSI Technology</td><td class="calibre61">VM009</td><td class="calibre77">1993</td><td class="calibre77">33 MHz</td><td class="calibre77">14.0 MByte/s</td><td class="calibre77">Y</td></tr>
<tr class="calibre71"><td class="calibre78">VLSI Technology</td><td class="calibre78">6868</td><td class="calibre79">1995</td><td class="calibre79">32 MHz</td><td class="calibre79">64.0 MByte/s</td><td class="calibre79">Y</td></tr>
<tr class="calibre25"><td class="calibre61">Western Digital</td><td class="calibre61">WD2001/2002</td><td class="calibre77">1984</td><td class="calibre77">3 MHz</td><td class="calibre77">0.23 MByte/s</td><td class="calibre77">N</td></tr>
</tbody></table>

<p class="calibre39">The most impressive DES chip is VLSI’s 6868 (formerly called
“Gatekeeper”). Not only can it perform DES encryption in only 8 clock cycles
(prototypes in the lab can do it in 4 clock cycles), but it can also do ECB
triple-DES in 25 clock cycles, and OFB or CBC triple-DES in 35 clock cycles.
This sounds impossible to me, too, but I assure you it works.</p>

<p class="calibre9">A software implementation of DES on an IBM 3090 mainframe can perform
32,000 DES encryptions per second. Most microcomputers are slower, but
impressive nonetheless. Table 12.10 [<a href="Applied%20Cryptography_split_035.html#r603" class="calibre5 pcalibre">603</a>,<a href="Applied%20Cryptography_split_035.html#r793" class="calibre5 pcalibre">793</a>] gives actual results and
estimates for various Intel and Motorola microprocessors.</p>

<table class="data-table1" id="table-12-10">
<caption class="calibre67">Table 12.10 - DES Speeds on Different Microprocessors and Computers</caption>
<tbody class="calibre24"><tr class="calibre68">
<th class="calibre26">Processor</th>
<th class="calibre26">Speed (in MHz)</th>
<th class="calibre26">DES Blocks (per second)</th>
</tr>
<tr class="calibre25"><td class="calibre61">8088</td><td class="calibre77">4.7</td><td class="calibre77">370</td></tr>
<tr class="calibre25"><td class="calibre61">68000</td><td class="calibre77">7.6</td><td class="calibre77">900</td></tr>
<tr class="calibre25"><td class="calibre61">80286</td><td class="calibre77">6</td><td class="calibre77">1,100</td></tr>
<tr class="calibre25"><td class="calibre61">68020</td><td class="calibre77">16</td><td class="calibre77">3,500</td></tr>
<tr class="calibre25"><td class="calibre61">68030</td><td class="calibre77">16</td><td class="calibre77">3,900</td></tr>
<tr class="calibre25"><td class="calibre61">80386</td><td class="calibre77">25</td><td class="calibre77">5,000</td></tr>
<tr class="calibre25"><td class="calibre61">68030</td><td class="calibre77">50</td><td class="calibre77">10,000</td></tr>
<tr class="calibre25"><td class="calibre61">68040</td><td class="calibre77">25</td><td class="calibre77">16,000</td></tr>
<tr class="calibre25"><td class="calibre61">68040</td><td class="calibre77">40</td><td class="calibre77">23,000</td></tr>
<tr class="calibre25"><td class="calibre61">80486</td><td class="calibre77">66</td><td class="calibre77">43,000</td></tr>
<tr class="calibre25"><td class="calibre61">Sun ELC</td><td class="calibre77"/><td class="calibre77">26,000</td></tr>
<tr class="calibre25"><td class="calibre61">HyperSparc</td><td class="calibre77"/><td class="calibre77">32,000</td></tr>
<tr class="calibre25"><td class="calibre61">RS6000-350</td><td class="calibre77"/><td class="calibre77">53,000</td></tr>
<tr class="calibre25"><td class="calibre61">Sparc 10/52</td><td class="calibre77"/><td class="calibre77">84,000</td></tr>
<tr class="calibre71"><td class="calibre78">DEC Alpha 4000/610</td><td class="calibre79"/><td class="calibre79">154,000</td></tr>
<tr class="calibre25"><td class="calibre61">HP 9000/887</td><td class="calibre77">125</td><td class="calibre77">196,000</td></tr>
</tbody></table>


<h3 id="12.3" class="calibre7">12.3 Security of DES</h3>

<p class="calibre9">People have long questioned the security of DES [<a href="Applied%20Cryptography_split_035.html#r458" class="calibre5 pcalibre">458</a>]. There has been much
speculation on the key length, number of iterations, and design of the S-boxes.
The S-boxes were particularly mysterious — all those constants, without any
apparent reason as to why or what they’re for. Although IBM claimed that the
inner workings were the result of 17 man-years of intensive cryptanalysis
some people feared that the NSA embedded a trapdoor into the algorithm so
they would have an easy means of decrypting messages.</p>

<p class="calibre9">The U.S. Senate Select Committee on Intelligence, with full top-secret
clearances, investigated the matter in 1978. The findings of the committee are
classified, but an unclassified summary of those findings exonerated the NSA
from any improper involvement in the algorithm’s design [<a href="Applied%20Cryptography_split_036.html#r1552" class="calibre5 pcalibre">1552</a>]. “It was said
to have convinced IBM that a shorter key was adequate, to have indirectly
assisted in the development of the S-box structures and to have certified that
the final DES algorithm was, to the best of their knowledge, free of any
statistical or mathematical weaknesses” [<a href="Applied%20Cryptography_split_035.html#r435" class="calibre5 pcalibre">435</a>]. However, since the government
never made the details of the investigation public, many people remained
unconvinced.</p>

<p class="calibre9">Tuchman and Meyer, two of the IBM cryptographers who designed DES, said
the NSA did not alter the design [<a href="Applied%20Cryptography_split_036.html#r841" class="calibre5 pcalibre">841</a>]:</p>

<p class="quote">Their basic approach was to look for strong substitution,
permutation, and key scheduling functions.... IBM has classified
the notes containing the selection criteria at the request of the
NSA.... “The NSA told us we had inadvertently reinvented some
of the deep secrets it uses to make its own algorithms,” explains
Tuchman.</p>

<p class="calibre9">Later in the article, Tuchman is quoted: “We developed the DES algorithm
entirely within IBM using IBMers. The NSA did not dictate a single wire!”
Tuchman reaffirmed this when he spoke on the history of DES at the 1992
National Computer Security Conference.</p>

<p class="calibre9">On the other hand, Coppersmith wrote [<a href="Applied%20Cryptography_split_035.html#r373" class="calibre5 pcalibre">373</a>,<a href="Applied%20Cryptography_split_035.html#r374" class="calibre5 pcalibre">374</a>]: “The National Security
Agency (NSA) also provided technical advice to IBM.” And Konheim has
been quoted as saying: “We sent the S-boxes off to Washington. They came
back and were all different. We ran our tests and they passed.” People have
pointed to this as evidence that the NSA put a trapdoor in DES.</p>

<p class="calibre9">NSA, when questioned regarding any imposed weakness in DES, said [<a href="Applied%20Cryptography_split_035.html#r363" class="calibre5 pcalibre">363</a>]:</p>

<p class="quote">Regarding the Data Encryption Standard (DES), we believe that
the public record from the Senate Committee for Intelligence’s
investigation in 1978 into NSA’s role in the development of the
DES is responsive to your question. That committee report
indicated that NSA did not tamper with the design of the
algorithm in any way and that the security afforded by the DES
was more than adequate for at least a 5–10 year time span for the
unclassified data for which it was intended. In short, NSA did not
impose or attempt to impose any weakness on the DES.</p>

<p class="calibre9">Then why did they modify the S-boxes? Perhaps it was to ensure that IBM did
not put a trapdoor in DES. The NSA had no reason to trust IBM’s researchers,
and would be lax in their duty if they did not make absolutely sure that DES
was free of trapdoors. Dictating the S-boxes is one way they could make sure.</p>

<p class="calibre9">Very recently some new cryptanalysis results have shed some light on this
issue, but for many years this has been the subject of much speculation.</p>

<h4 class="calibre8">Weak Keys</h4>

<p class="calibre9">Because of the way the initial key is modified to get a subkey for each round
of the algorithm, certain initial keys are <b class="calibre10">weak keys</b> [<a href="Applied%20Cryptography_split_035.html#r721" class="calibre5 pcalibre">721</a>,<a href="Applied%20Cryptography_split_035.html#r427" class="calibre5 pcalibre">427</a>]. Remember that
the initial value is split into two halves, and each half is shifted independently.
If all the bits in each half are either 0 or 1, then the key used for any cycle of
the algorithm is the same for all the cycles of the algorithm. This can occur if
the key is entirely 1s, entirely 0s, or if one half of the key is entirely 1s and the
other half is entirely 0s. Also, two of the weak keys have other properties that
make them less secure [<a href="Applied%20Cryptography_split_035.html#r427" class="calibre5 pcalibre">427</a>].</p>

<p class="calibre9">The four weak keys are shown in hexadecimal notation in Table 12.11.
(Remember that every eighth bit is a parity bit.)</p>

<table class="data-table1" id="table-12-11">
<caption class="calibre67">Table 12.11 - DES Weak Keys</caption>
<tbody class="calibre24"><tr class="calibre68">
<th class="calibre26">Weak Key Value (with parity bits)</th>
<th class="calibre26">Actual Key</th>
</tr>
<tr class="calibre25"><td class="calibre80">0101 0101 0101 0101</td><td class="calibre80">0000000 0000000</td></tr>
<tr class="calibre25"><td class="calibre80">1F1F 1F1F 0E0E 0E0E</td><td class="calibre80">0000000 FFFFFFF</td></tr>
<tr class="calibre71"><td class="calibre81">E0E0 E0E0 F1F1 F1F1</td><td class="calibre81">FFFFFFF 0000000</td></tr>
<tr class="calibre25"><td class="calibre80">FEFE FEFE FEFE FEFE</td><td class="calibre80">FFFFFFF FFFFFFF</td></tr>
</tbody></table>

<p class="calibre39">Additionally, some pairs of keys encrypt plaintext to the identical ciphertext.
In other words, one key in the pair can decrypt messages encrypted with the
other key in the pair. This is due to the way in which DES generates subkeys;
instead of generating 16 different subkeys, these keys generate only two
different subkeys. Each of these subkeys is used eight times in the algorithm.
These keys are called <b class="calibre10">semiweak keys, </b> and are shown in hexadecimal notation
in Table 12.12.</p>

<table class="data-table1" id="table-12-12">
<caption class="calibre67">Table 12.12 - DES Semiweak Key Pairs</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre82">01FE 01FE 01FE 01FE  and  FE01 FE01 FE01 FE01</td></tr>
<tr class="calibre25"><td class="calibre83">1FE0 1FE0 0EF1 0EF1  and  E01F E01F F10E F10E</td></tr>
<tr class="calibre25"><td class="calibre83">01E0 01E0 01F1 01F1  and  E001 E001 F101 F101</td></tr>
<tr class="calibre25"><td class="calibre83">1FFE 1FFE 0EFE 0EFE  and  FE1F FE1F FE0E FE0E</td></tr>
<tr class="calibre71"><td class="calibre84">011F 011F 010E 010E  and  1F01 1F01 0E01 0E01</td></tr>
<tr class="calibre25"><td class="calibre83">E0FE E0FE F1FE F1FE  and  FEE0 FEE0 FEF1 FEF1</td></tr>
</tbody></table>

<p class="calibre39">Some keys produce only four subkeys, each used four times in the algorithm.
These <b class="calibre10">possibly weak</b> keys are listed in Table 12.13.</p>

<table class="data-table1" id="table-12-13">
<caption class="calibre67">Table 12.13 - DES Possibly Weak Keys</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="calibre85">1F 1F 01 01 0E 0E 01 01</td><td class="calibre82">E0 01 01 E0 F1 01 01 F1</td></tr>
<tr class="calibre25"><td class="calibre86">01 1F 1F 01 01 0E 0E 01</td><td class="calibre83">FE 1F 01 E0 FE 0E 01 F1</td></tr>
<tr class="calibre25"><td class="calibre86">1F 01 01 1F 0E 01 01 0E</td><td class="calibre83">FE 01 1F E0 FE 01 0E F1</td></tr>
<tr class="calibre25"><td class="calibre86">01 01 1F 1F 01 01 0E 0E</td><td class="calibre83">E0 1F 1F E0 F1 0E 0E F1</td></tr>
<tr class="calibre25"><td class="calibre86"/><td class="calibre83">FE 01 01 FE FE 01 01 FE</td></tr>
<tr class="calibre25"><td class="calibre86">E0 E0 01 01 F1 F1 01 01</td><td class="calibre83">E0 1F 01 FE F1 0E 01 FE</td></tr>
<tr class="calibre25"><td class="calibre86">FE FE 01 01 FE FE 01 01</td><td class="calibre83">E0 01 1F FE F1 01 0E FE</td></tr>
<tr class="calibre25"><td class="calibre86">FE E0 1F 01 FE F1 0E 01</td><td class="calibre83">FE 1F 1F FE FE 0E 0E FE</td></tr>
<tr class="calibre25"><td class="calibre86">E0 FE 1F 01 F1 FE 0E 01</td><td class="calibre83"/></tr>
<tr class="calibre25"><td class="calibre86">FE E0 01 1F FE F1 01 0E</td><td class="calibre83">1F FE 01 E0 0E FE 01 F1</td></tr>
<tr class="calibre25"><td class="calibre86">E0 FE 01 1F F1 FE 01 0E</td><td class="calibre83">01 FE 1F E0 01 FE 0E F1</td></tr>
<tr class="calibre25"><td class="calibre86">E0 E0 1F 1F F1 F1 0E 0E</td><td class="calibre83">1F E0 01 FE 0E F1 01 FE</td></tr>
<tr class="calibre25"><td class="calibre86">FE FE 1F 1F FE FE 0E 0E</td><td class="calibre83">01 E0 1F FE 01 F1 0E FE</td></tr>
<tr class="calibre25"><td class="calibre86"> </td><td class="calibre83"> </td></tr>
<tr class="calibre25"><td class="calibre86">FE 1F E0 01 FE 0E F1 01</td><td class="calibre83">01 01 E0 E0 01 01 F1 F1</td></tr>
<tr class="calibre25"><td class="calibre86">E0 1F FE 01 F1 0E FE 01</td><td class="calibre83">1F 1F E0 E0 0E 0E F1 F1</td></tr>
<tr class="calibre25"><td class="calibre86">FE 01 E0 1F FE 01 F1 0E</td><td class="calibre83">1F 01 FE E0 0E 01 FE F1</td></tr>
<tr class="calibre25"><td class="calibre86">E0 01 FE 1F F1 01 FE 0E</td><td class="calibre83">01 1F FE E0 01 0E FE F1</td></tr>
<tr class="calibre25"><td class="calibre86"/><td class="calibre83">1F 01 E0 FE 0E 01 F1 FE</td></tr>
<tr class="calibre25"><td class="calibre86">01 E0 E0 01 01 F1 F1 01</td><td class="calibre83">01 1F E0 FE 01 0E F1 FE</td></tr>
<tr class="calibre25"><td class="calibre86">1F FE E0 01 0E FE F0 01</td><td class="calibre83">01 01 FE FE 01 01 FE FE</td></tr>
<tr class="calibre25"><td class="calibre86">1F E0 FE 01 0E F1 FE 01</td><td class="calibre83">1F 1F FE FE 0E 0E FE FE</td></tr>
<tr class="calibre25"><td class="calibre86">01 FE FE 01 01 FE FE 01</td><td class="calibre83"/></tr>
<tr class="calibre25"><td class="calibre86">1F E0 E0 1F 0E F1 F1 0E</td><td class="calibre83">FE FE E0 E0 FE FE F1 F1</td></tr>
<tr class="calibre25"><td class="calibre86">01 FE E0 1F 01 FE F1 0E</td><td class="calibre83">E0 FE FE E0 F1 FE FE F1</td></tr>
<tr class="calibre71"><td class="calibre87">01 E0 FE 1F 01 F1 FE 0E</td><td class="calibre84">FE E0 E0 FE FE F1 F1 FE</td></tr>
<tr class="calibre25"><td class="calibre86">1F FE FE 1F 0E FE FE 0E</td><td class="calibre83">E0 E0 FE FE F1 F1 FE FE</td></tr>
</tbody></table>

<p class="calibre39">Before condemning DES for having weak keys, consider that this list of 64
keys is minuscule compared to the total set of 72,057,594,037,927,936
possible keys. If you select a random key, the odds of picking one of these
keys is negligible. If you are truly paranoid, you could always check for weak
keys during key generation. Some people don’t think it’s worth the bother.
Others say that it’s so easy to check, there’s no reason not to.</p>

<p class="calibre9">There is further analysis on weak and semiweak keys in [<a href="Applied%20Cryptography_split_036.html#r1116" class="calibre5 pcalibre">1116</a>], and additional
key patterns have been investigated for weaknesses. None have been found.</p>

<h4 class="calibre8">Complement Keys</h4>

<p class="calibre9">Take the bit-wise complement of a key; that is, replace all the 0s with 1s and
the 1s with 0s. Now, if the original key encrypts a block of plaintext, then the
complement of the key will encrypt the complement of the plaintext block into
the complement of the ciphertext block.</p>

<p class="calibre9">If <i class="calibre12">x’</i> is the complement of <i class="calibre12">x, </i> then the identity is as follows:</p>

<p class="math"><i class="calibre12">E<sub class="calibre15">K</sub></i>(<i class="calibre12">P</i>) = <i class="calibre12">C</i>
<i class="calibre12">E<sub class="calibre15">K</sub>’</i>(<i class="calibre12">P’</i>) = <i class="calibre12">C’</i>
</p>

<p class="calibre9">This isn’t anything mysterious. The subkeys are XORed with the right half
after the expansion permutation in every round. This <b class="calibre10">complementation</b>
<b class="calibre10">property</b> is a direct result of that fact.</p>

<p class="calibre9">What this means is that a chosen-plaintext attack against DES only has to test
half the possible keys: 2<sup class="calibre19">55</sup> keys instead of 2<sup class="calibre19">56</sup> [<a href="Applied%20Cryptography_split_036.html#r1080" class="calibre5 pcalibre">1080</a>]. Eli Biham and Adi
Shamir showed [<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>] that there is a known-plaintext attack of the same
complexity, requiring at least 2<sup class="calibre19">33</sup> known plaintexts.</p>

<p class="calibre9">It is questionable whether this is a weakness, since most messages don’t have
complement blocks of plaintext (in random plaintext, the odds against it are
extremely high) and users can be warned not to use complement keys.</p>

<h4 class="calibre8">Algebraic Structure</h4>

<p class="calibre9">All possible 64-bit plaintext blocks can be mapped onto all possible 64-bit
ciphertext blocks in 2<sup class="calibre19">64</sup>! different ways. The DES algorithm, with its 56-bit
key, gives us 2<sup class="calibre19">56</sup> (approximately 10<sup class="calibre19">17</sup>) of these mappings. Using multiple
encryption, it seems possible to reach a larger portion of those possible
mappings. However, this is only true if the DES operation does not have
certain algebraic structures.</p>

<p class="calibre9">If DES were <b class="calibre10">closed, </b> then for any <i class="calibre12">K</i><sub class="calibre15">1</sub> and <i class="calibre12">K</i><sub class="calibre15">2</sub> there would always be a <i class="calibre12">K</i><sub class="calibre15">3</sub> such that</p>

<p class="math"><i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">2</sub></sub>(<i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">1</sub></sub>(<i class="calibre12">P</i>)) = <i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">3</sub></sub>(<i class="calibre12">P</i>)
</p>

<p class="calibre9">In other words, the DES encryption operation would form a group, and
encrypting a set of plaintext blocks with <i class="calibre12">K</i><sub class="calibre15">1</sub> followed by <i class="calibre12">K</i><sub class="calibre15">2</sub> 
would be identical to encrypting the blocks with <i class="calibre12">K</i><sub class="calibre15">3</sub>. Even worse, DES would be vulnerable to a
meet-in-the-middle known-plaintext attack that runs in only 228 steps [<a href="Applied%20Cryptography_split_035.html#r807" class="calibre5 pcalibre">807</a>].</p>

<p class="calibre9">If DES were <b class="calibre10">pure, </b> then for any <i class="calibre12">K</i><sub class="calibre15">1</sub> <i class="calibre12">K</i><sub class="calibre15">2</sub> and <i class="calibre12">K</i><sub class="calibre15">3</sub> there would always be a <i class="calibre12">K</i><sub class="calibre15">4</sub> such that</p>

<p class="math"><i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">3</sub></sub>(<i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">2</sub></sub>(<i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">1</sub></sub>(<i class="calibre12">P</i>))) = <i class="calibre12">E</i><sub class="calibre15"><i class="calibre22">K</i><sub class="calibre16">4</sub></sub>(<i class="calibre12">P</i>)
</p>

<p class="calibre9">Triple encryption would be useless. (Note that a closed cipher is necessarily
pure but a pure cipher is not necessarily closed.)</p>

<p class="calibre9">An early theoretical paper by Don Coppersmith gave some hints, but it wasn’t
enough [<a href="Applied%20Cryptography_split_035.html#r377" class="calibre5 pcalibre">377</a>]. Various cryptographers wrestled with this question
[<a href="Applied%20Cryptography_split_035.html#r588" class="calibre5 pcalibre">588</a>,<a href="Applied%20Cryptography_split_035.html#r427" class="calibre5 pcalibre">427</a>,<a href="Applied%20Cryptography_split_035.html#r431" class="calibre5 pcalibre">431</a>,<a href="Applied%20Cryptography_split_035.html#r527" class="calibre5 pcalibre">527</a>,<a href="Applied%20Cryptography_split_035.html#r723" class="calibre5 pcalibre">723</a>,<a href="Applied%20Cryptography_split_035.html#r789" class="calibre5 pcalibre">789</a>]. Cycling experiments gathered “overwhelming
evidence” that DES is not a group [<a href="Applied%20Cryptography_split_035.html#r807" class="calibre5 pcalibre">807</a>,<a href="Applied%20Cryptography_split_035.html#r371" class="calibre5 pcalibre">371</a>,<a href="Applied%20Cryptography_split_035.html#r808" class="calibre5 pcalibre">808</a>,<a href="Applied%20Cryptography_split_036.html#r1116" class="calibre5 pcalibre">1116</a>,<a href="Applied%20Cryptography_split_035.html#r809" class="calibre5 pcalibre">809</a>], but it wasn’t until
1992 that cryptographers proved that DES is not a group [<a href="Applied%20Cryptography_split_035.html#r293" class="calibre5 pcalibre">293</a>]. Coppersmith
said that the IBM team knew it all along.</p>

<h4 class="calibre8">Key Length</h4>

<p class="calibre9">IBM’s original submission to NBS had a 112-bit key. By the time the DES
became a standard, that was reduced to a 56-bit key. Many cryptographers
argued for the longer key. Their arguments centered on the possibility of a
brute-force attack (see <a href="Applied%20Cryptography_split_009.html#7.1" class="calibre5 pcalibre">Section 7.1</a>).</p>

<p class="calibre9">In 1976 and 1977, Diffie and Hellman argued that a special-purpose
DES-cracking parallel computer could recover the key in a day and cost $20
million. In 1981, Diffie upped this to a two-day search time and a cost of $50
million [<a href="Applied%20Cryptography_split_035.html#r491" class="calibre5 pcalibre">491</a>]. Diffie and Hellman argued then that this was out of reach for
everybody except organizations like the NSA, but that by 1990 DES would be
totally insecure [<a href="Applied%20Cryptography_split_035.html#r714" class="calibre5 pcalibre">714</a>].</p>

<p class="calibre9">Hellman [<a href="Applied%20Cryptography_split_035.html#r716" class="calibre5 pcalibre">716</a>] presented another argument against the small key size: By
trading memory space for time, it would be possible to speed up the searching
process. He suggested the possibility of computing and storing 256 possible
results of encrypting a single plaintext block under every possible key. Then,
to break an unknown key, all that would be required would be for the
cryptanalyst to insert the plaintext block into the encryption stream, recover
the resulting ciphertext, and look the key up. Hellman pegged the cost of this
cracking machine at $5 million.</p>

<p class="calibre9">Arguments for and against the existence of a DES-cracker lurking in some
government basement somewhere have continued. Several people pointed out
that the mean time between failures for the DES chips would never be high
enough to ensure that the machine would work. This objection was shown to
be superfluous in [<a href="Applied%20Cryptography_split_036.html#r1278" class="calibre5 pcalibre">1278</a>]. Others suggested ways to speed the process even
further and to reduce the effects of chip failures.</p>

<p class="calibre9">Meanwhile, hardware implementations of DES slowly approached the
million-encryptions-per-second requirement of Diffie and Hellman’s
special-purpose machine. In 1984 DES chips capable of performing 256,000
encryptions per second had been produced [<a href="Applied%20Cryptography_split_035.html#r533" class="calibre5 pcalibre">533</a>,<a href="Applied%20Cryptography_split_035.html#r534" class="calibre5 pcalibre">534</a>]. By 1987 chips
performing 512,000 encryptions per second were being developed, and a
version capable of checking over a million keys per second was feasible
[<a href="Applied%20Cryptography_split_035.html#r738" class="calibre5 pcalibre">738</a>,<a href="Applied%20Cryptography_split_036.html#r1573" class="calibre5 pcalibre">1573</a>]. And in 1993 Michael Wiener designed a $1 million machine that
could complete a brute-force attack against DES in an average of 3.5 hours
(see <a href="Applied%20Cryptography_split_009.html#7.1" class="calibre5 pcalibre">Section 7.1</a>).</p>

<p class="calibre9">No one has publicly admitted building this machine, although it is a reasonable
assumption that someone has. A million dollars is not a lot of money to a
large — or even a medium-sized — country.</p>

<p class="calibre9">It was not until 1990 that two Israeli mathematicians, Biham and Shamir,
discovered <b class="calibre10">differential cryptanalysis, </b> a technique that put to rest the question of key length. 
Before we discuss that technique, let’s turn to some other design
criticisms of DES.</p>

<h4 class="calibre8">Number of Rounds</h4>

<p class="calibre9">Why 16 rounds? Why not 32? After five rounds every ciphertext bit is a
function of every plaintext bit and every key bit [<a href="Applied%20Cryptography_split_036.html#r1078" class="calibre5 pcalibre">1078</a>,<a href="Applied%20Cryptography_split_036.html#r1080" class="calibre5 pcalibre">1080</a>], and after eight
rounds the ciphertext was essentially a random function of every plaintext bit
and every key bit [<a href="Applied%20Cryptography_split_036.html#r880" class="calibre5 pcalibre">880</a>]. (This is called the avalanche effect.) So why not stop
after eight rounds?</p>

<p class="calibre9">Over the years, variants of DES with a reduced number of rounds have been
successfully attacked. DES with three or four rounds was easily broken in
1982 [<a href="Applied%20Cryptography_split_035.html#r49" class="calibre5 pcalibre">49</a>]. DES with six rounds fell some years later [<a href="Applied%20Cryptography_split_035.html#r336" class="calibre5 pcalibre">336</a>]. Biham and
Shamir’s differential cryptanalysis explained this as well: DES with any
number of rounds fewer than 16 could be broken with a known-plaintext attack
more efficiently than by a brute-force attack. Certainly brute-force is a much
more likely attack, but it is interesting that the algorithm has exactly 16
rounds.</p>

<h4 class="calibre8">Design of the S-Boxes</h4>

<p class="calibre9">In addition to being accused of reducing the key length, NSA was also accused
of modifying the contents of the S-boxes. When pressed for design
justification for the S-boxes, the NSA indicated that elements of the
algorithm’s design were “sensitive” and would not be made public. Many
cryptographers were concerned that the NSA-designed S-boxes hid a trapdoor,
making it possible for them to easily cryptanalyze the algorithm.</p>

<p class="calibre9">Since then, considerable effort has gone into analyzing the design and
operation of the S-boxes. In the mid-1970s, Lexar Corporation [<a href="Applied%20Cryptography_split_036.html#r961" class="calibre5 pcalibre">961</a>,<a href="Applied%20Cryptography_split_035.html#r721" class="calibre5 pcalibre">721</a>] and
Bell Laboratories [<a href="Applied%20Cryptography_split_036.html#r1120" class="calibre5 pcalibre">1120</a>] examined the operation of the S-boxes. Neither
analysis revealed any weaknesses, although both found inexplicable features.
The S-boxes had more features in common with a linear transformation than
one would expect if they were chosen at random. The Bell Laboratories team
stated that the S-boxes may have hidden trapdoors, and the Lexar report
concluded with:</p>

<p class="quote">Structures have been found in DES that were undoubtedly
inserted to strengthen the system against certain types of attack.
Structures have also been found that appear to weaken the system.</p>

<p class="calibre9">On the other hand, this report also warned:</p>

<p class="quote">...the problem [of the search for structure in the S-boxes] is
complicated by the ability of the human mind to find apparent
structure in random data, which is really not structure at all.</p>

<p class="calibre9">At the second workshop on DES, the National Security Agency revealed
several design criteria behind the S-boxes [<a href="Applied%20Cryptography_split_035.html#r229" class="calibre5 pcalibre">229</a>]. This did nothing to quell
people’s suspicions, and the debate continued [<a href="Applied%20Cryptography_split_035.html#r228" class="calibre5 pcalibre">228</a>,<a href="Applied%20Cryptography_split_035.html#r422" class="calibre5 pcalibre">422</a>,<a href="Applied%20Cryptography_split_035.html#r714" class="calibre5 pcalibre">714</a>,<a href="Applied%20Cryptography_split_036.html#r1506" class="calibre5 pcalibre">1506</a>,<a href="Applied%20Cryptography_split_036.html#r1551" class="calibre5 pcalibre">1551</a>].</p>

<p class="calibre9">Various oddities about the S-boxes appeared in the literature. The last three
output bits of the fourth S-box can be derived in the same way as the first by
complementing some of the input bits [<a href="Applied%20Cryptography_split_035.html#r436" class="calibre5 pcalibre">436</a>,<a href="Applied%20Cryptography_split_035.html#r438" class="calibre5 pcalibre">438</a>]. Two different, but carefully
chosen, inputs to S-boxes can produce the same output [<a href="Applied%20Cryptography_split_035.html#r436" class="calibre5 pcalibre">436</a>]. It is possible to
obtain the same output of a single DES round by changing bits in only three
neighboring S-boxes [<a href="Applied%20Cryptography_split_035.html#r487" class="calibre5 pcalibre">487</a>]. Shamir noticed that the S-boxes entries appeared
to be somewhat imbalanced, but wasn’t about to turn that imbalance into an
attack [<a href="Applied%20Cryptography_split_036.html#r1423" class="calibre5 pcalibre">1423</a>]. (He mentioned a feature of the fifth S-box, but it took another
eight years before linear cryptanalysis exploited that feature.) Other
researchers showed that publicly known design principles could be used to
generate S-boxes with the observed characteristics [<a href="Applied%20Cryptography_split_035.html#r266" class="calibre5 pcalibre">266</a>].</p>

<h4 class="calibre8">Additional Results</h4>

<p class="calibre9">There were other attempts to cryptanalyze DES. One cryptographer looked at
nonrandomness based on spectral tests [<a href="Applied%20Cryptography_split_035.html#r559" class="calibre5 pcalibre">559</a>]. Others analyzed sequences of
linear factors, but their attack failed after eight rounds [<a href="Applied%20Cryptography_split_036.html#r1297" class="calibre5 pcalibre">1297</a>,<a href="Applied%20Cryptography_split_035.html#r336" class="calibre5 pcalibre">336</a>,<a href="Applied%20Cryptography_split_035.html#r531" class="calibre5 pcalibre">531</a>]. A 1987
unpublished attack by Donald Davies exploited the way the expansion
permutation repeats bits into adjacent S-boxes; this attack is also impractical
after eight rounds [<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>,<a href="Applied%20Cryptography_split_035.html#r429" class="calibre5 pcalibre">429</a>].</p>

<h3 id="12.4" class="calibre7">12.4 Differential and Linear Cryptanalysis</h3>

<h4 class="calibre8">Differential Cryptanalysis</h4>

<p class="calibre9">In 1990, Eli Biham and Adi Shamir introduced <b class="calibre10">differential cryptanalysis</b>
[<a href="Applied%20Cryptography_split_035.html#r167" class="calibre5 pcalibre">167</a>,<a href="Applied%20Cryptography_split_035.html#r168" class="calibre5 pcalibre">168</a>,<a href="Applied%20Cryptography_split_035.html#r171" class="calibre5 pcalibre">171</a>,<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>]. This is a new method of cryptanalysis, heretofore unknown
to the public. Using this method, Biham and Shamir found a chosen-plaintext
attack against DES that was more efficient than brute force.</p>

<p class="calibre9">Differential cryptanalysis looks specifically at <b class="calibre10">ciphertext pairs</b>: pairs of
ciphertexts whose plaintexts have particular differences. It analyzes the
evolution of these differences as the plaintexts propagate through the rounds of
DES when they are encrypted with the same key.</p>

<p class="calibre9">Simply, choose pairs of plaintexts with a fixed difference. The two plaintexts
can be chosen at random, as long as they satisfy particular difference
conditions; the cryptanalyst does not even have to know their values. (For
DES, the term “difference” is defined using XOR. This can be different for
different algorithms.) Then, using the differences in the resulting ciphertexts,
assign different probabilities to different keys. As you analyze more and more
ciphertext pairs, one key will emerge as the most probable. This is the correct
key.</p>

<p class="calibre9">The details are more complicated. Figure 12.5 is the DES round function.
Imagine a pair of inputs, <i class="calibre12">X</i> and <i class="calibre12">X’</i>, that have the difference Δ<i class="calibre12">X</i>. The outputs, <i class="calibre12">Y</i>
and <i class="calibre12">Y’</i> are known, and therefore so is the difference, <i class="calibre12">Y</i>. Both the 
expansion permutation and the P-box are known, so Δ<i class="calibre12">A</i> and Δ<i class="calibre12">C</i> are 
known. <i class="calibre12">B</i> and <i class="calibre12">B’</i> are not known, but their difference Δ<i class="calibre12">B</i> is known 
and equal to Δ<i class="calibre12">A</i>. (When looking at the difference, the XORing of <i class="calibre12">K<sub class="calibre15">i</sub> </i>
with <i class="calibre12">A</i> and <i class="calibre12">A’</i> cancels out.) So far, so good.
Here’s the trick: For any given Δ<i class="calibre12">A</i>, not all 
values of Δ<i class="calibre12">C</i> are equally likely. The combination of Δ<i class="calibre12">A</i> and Δ<i class="calibre12">C</i> suggests values for bits of <i class="calibre12">A</i> XOR <i class="calibre12">K<sub class="calibre15">i</sub></i> and <i class="calibre12">A’</i> XOR
<i class="calibre12">K<sub class="calibre15">i</sub></i>. Since <i class="calibre12">A</i> and <i class="calibre12">A’</i> are known, this gives us information about <i class="calibre12">K<sub class="calibre15">i</sub></i>.</p>

<div class="figure" id="figure-12-5">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-5.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.5</b> DES round function.</i></p>
</div>

<p class="calibre9">Look at the last round of DES. (Differential cryptanalysis ignores the initial
and final permutation. They have no effect on the attack, except to make it
harder to explain.) If we can identify <i class="calibre12">K</i><sub class="calibre15">16</sub> then we have 48 bits of the key.
(Remember, the subkey in each round consists of 48 bits of the 56-bit key.)
The other 8 bits we can get by brute force. Differential cryptanalysis will get
us <i class="calibre12">K</i><sub class="calibre15">16</sub>.</p>

<p class="calibre9">Certain differences in plaintext pairs have a high probability of causing certain
differences in the resulting ciphertext pairs. These are called <b class="calibre10">characteristics</b>.
Characteristics extend over a number of rounds and essentially define a path
through these rounds. There is an input difference, a difference at each round,
and an output difference — with a specific probability.</p>

<p class="calibre9">You can find these characteristics by generating a table where the rows
represent the possible input XORs (the XOR of two different sets of input
bits), the columns represent the possible output XORs, and the entries
represent the number of times a particular output XOR occurs for a given input
XOR. You can generate such a table for each of DES’s eight S-boxes.</p>

<p class="calibre9">For example, Figure 12.6a is a one-round characteristic. They input difference
of the left side is <i class="calibre12">L; </i> it could be anything. The input difference of the right side is 0. (The two inputs have the same right-hand side, so their difference is 0.)
Since there is no difference going in to the round function, then there is no
difference coming out of the round function. Therefore, the output difference
of the left side is <i class="calibre12">L</i> ⊕ 0 = <i class="calibre12">L, </i> and the output difference of the right side is 0. This is a trivial characteristic, and is true with probability 1.</p>

<p class="calibre9">Figure 12.6b is a less obvious characteristic. Again, the input difference to the
left side is arbitrary: <i class="calibre12">L</i>. The input difference to the right side is 0x60000000; the two inputs differ in only the second and third bits. With a probability of
14/64, the output difference of the round function is <i class="calibre12">L</i> ⊕ 0x00808200. This means
that the output difference of the left side is <i class="calibre12">L</i> ⊕ 0x00808200 and the output
difference of the right side is 0x60000000 — with probability 14/64.</p>

<div class="figure" id="figure-12-6">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-6.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.6</b> DES characteristics.</i></p>
</div>

<p class="calibre9">Different characteristics can be joined. And, assuming the rounds are
independent, the probabilities can be multiplied. Figure 12.7 joins the two
characteristics previously described. The input difference to the left side is
0x00808200 and the input difference to the right side is 0x60000000. At the
end of the first round the input difference and the output of the round function
cancel out, leaving an output difference of 0. This feeds into the second round;
the final output difference of the left side is 0x60000000 and the final output
difference of the right side is 0. This two-round characteristic has a probability
of 14/64.</p>

<div class="figure" id="figure-12-7">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-7.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.7</b> A two-round DES characteristic.</i></p>
</div>

<p class="calibre9">A plaintext pair that satisfies the characteristic is a <b class="calibre10">right pair</b>. A plaintext pair which does not is a <b class="calibre10">wrong pair</b>. A right pair will suggest the correct round key (for the last round of the characteristic); a wrong pair will suggest a random
round key.</p>

<p class="calibre9">To find the correct round key, simply collect enough guesses so that one
subkey is suggested more often than all the others. In effect, the correct subkey
will rise out of all the random alternatives.</p>

<p class="calibre9">So, the basic differential attack on <i class="calibre12">n-</i>round DES will recover the 48-bit subkey used in round <i class="calibre12">n, </i> and the remaining 8 key bits are obtained by brute-force
guessing.</p>

<p class="calibre9">There are still considerable problems. First, there is a negligible chance of
success until you reach some threshold. That is, until you accumulate
sufficient data you can’t tell the correct subkey from all the noise. And the
attack isn’t practical: You have to use counters to assign different probabilities
to 2<sup class="calibre19">48</sup> possible subkeys, and too much data is required to make this work.</p>

<p class="calibre9">At this point, Biham and Shamir tweaked their attack. Instead of a using a
15-round characteristic on 16-round DES, they used a 13-round characteristic
and some tricks to get the last few rounds. A shorter characteristic with a
higher probability worked better. And they used some clever mathematics to
obtain 56-bit key candidates which could be tested immediately, eliminating
the need for counters. This attack succeeds as soon as a right pair is found; this
avoids the threshold and gives a linear success probability. If you have 1000
times fewer pairs, then you have 1000 times smaller chance of success. This
sounds terrible, but it is a lot better than the threshold. There is always some
chance of immediate success.</p>

<p class="calibre9">The results are most interesting. Table 12.14 is a summary of the best
differential attack against DES with varying numbers of rounds [<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>]. The first
column is the number of rounds. The next two columns are the numbers of
chosen plaintexts or known plaintexts that must be examined for the attack,
and the fourth column is the number of those plaintexts actually analyzed. The
last column is the complexity of analysis, after the required plaintexts are
found.</p>

<table class="data-table1" id="table-12-14">
<caption class="calibre67">Table 12.14 - Differential Cryptanalysis Attacks against DES</caption>
<tbody class="calibre24"><tr class="calibre68">
<th class="calibre26">No. of Rounds</th>
<th class="calibre26">Chosen Plaintexts</th>
<th class="calibre26">Known Plaintexts</th>
<th class="calibre26">Analyzed Plaintexts</th>
<th class="calibre26">Complexity of Analysis</th>
</tr>
<tr class="calibre25"><td class="calibre61">8</td><td class="calibre61">2<sup class="calibre47">14</sup></td><td class="calibre61">2<sup class="calibre47">38</sup></td><td class="calibre61">4</td><td class="calibre61">2<sup class="calibre47">9</sup></td></tr>
<tr class="calibre25"><td class="calibre61">9</td><td class="calibre61">2<sup class="calibre47">24</sup></td><td class="calibre61">2<sup class="calibre47">44</sup></td><td class="calibre61">2</td><td class="calibre61">2<sup class="calibre47">32†</sup></td></tr>
<tr class="calibre25"><td class="calibre61">10</td><td class="calibre61">2<sup class="calibre47">24</sup></td><td class="calibre61">2<sup class="calibre47">43</sup></td><td class="calibre61">2<sup class="calibre47">14</sup></td><td class="calibre61">2<sup class="calibre47">15</sup></td></tr>
<tr class="calibre25"><td class="calibre61">11</td><td class="calibre61">2<sup class="calibre47">31</sup></td><td class="calibre61">2<sup class="calibre47">47</sup></td><td class="calibre61">2</td><td class="calibre61">2<sup class="calibre47">32†</sup></td></tr>
<tr class="calibre25"><td class="calibre61">12</td><td class="calibre61">2<sup class="calibre47">31</sup></td><td class="calibre61">2<sup class="calibre47">47</sup></td><td class="calibre61">2<sup class="calibre47">21</sup></td><td class="calibre61">2<sup class="calibre47">21</sup></td></tr>
<tr class="calibre25"><td class="calibre61">13</td><td class="calibre61">2<sup class="calibre47">39</sup></td><td class="calibre61">2<sup class="calibre47">52</sup></td><td class="calibre61">2</td><td class="calibre61">2<sup class="calibre47">32†</sup></td></tr>
<tr class="calibre25"><td class="calibre61">14</td><td class="calibre61">2<sup class="calibre47">39</sup></td><td class="calibre61">2<sup class="calibre47">51</sup></td><td class="calibre61">2<sup class="calibre47">29</sup></td><td class="calibre61">2<sup class="calibre47">29</sup></td></tr>
<tr class="calibre25"><td class="calibre61">15</td><td class="calibre61">2<sup class="calibre47">47</sup></td><td class="calibre61">2<sup class="calibre47">56</sup></td><td class="calibre61">2<sup class="calibre47">7</sup></td><td class="calibre61">2<sup class="calibre47">37</sup></td></tr>
<tr class="last-data-row"><td class="calibre62">16</td><td class="calibre62">2<sup class="calibre47">47</sup></td><td class="calibre62">2<sup class="calibre47">55</sup></td><td class="calibre62">2<sup class="calibre47">36</sup></td><td class="calibre62">2<sup class="calibre47">37</sup></td></tr>
<tr class="calibre25"><td colspan="5" class="calibre61">† The complexity of the analysis can be greatly reduced for these variants by
using about four times as many plaintexts with the clique method.</td></tr>
</tbody></table>

<p class="calibre39">The best attack against full 16-round DES requires 2<sup class="calibre19">47</sup> chosen plaintexts. This
can be converted to a known plaintext attack, but that requires 2<sup class="calibre19">55</sup> known
plaintexts. And 2<sup class="calibre19">37</sup> DES operations are required during analysis.</p>

<p class="calibre9">Differential cryptanalysis works against DES and other similar algorithms with
constant S-boxes. The attack is heavily dependent on the structure of the
S-boxes; the ones in DES just happen to be optimized against differential
cryptanalysis. And the attack works against DES in any of its operating
modes — ECB, CBC, CFB, and OFB — with the same complexity [<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>].</p>

<p class="calibre9">DES’s resistance can be improved by increasing the number of rounds.
Chosen-plaintext differential cryptanalysis DES with 17 or 18 rounds takes
about the same time as a brute-force search [<a href="Applied%20Cryptography_split_035.html#r160" class="calibre5 pcalibre">160</a>]. At 19 rounds or more,
differential cryptanalysis becomes impossible because it requires more than
2<sup class="calibre19">64</sup> chosen plaintexts: Remember, DES has a 64-bit block size, so it only <i class="calibre12">has</i>
2<sup class="calibre19">64</sup> possible plaintext blocks. (In general, you can prove that an algorithm is
resistant to differential cryptanalysis by showing that the amount of plaintext
required to mount such an attack is greater than the amount of plaintext
possible.)</p>

<p class="calibre9">Here are a few important points. First, this attack is largely theoretical. The
enormous time and data requirements to mount a differential cryptanalytic
attack put it beyond the reach of almost everyone. To get the requisite data for
this attack against a full DES, you have to encrypt a 1.5 megabits-per-second
data stream of <i class="calibre12">chosen plaintext</i> for almost three years. Second, this is primarily a chosen-plaintext attack. It can be converted to a known-plaintext attack, but
you have to sift through all of the plaintext-ciphertext pairs looking for the
useful ones. For full 16-round DES, this makes the attack slightly less efficient
than brute force (the differential cryptanalytic attack requires 2<sup class="calibre19">55.1</sup> operations,
and brute force requires 2<sup class="calibre19">55</sup>). The consensus is that DES, when implemented
properly, is still secure against differential cryptanalysis.</p>

<p class="calibre9">Why is DES so resistant to differential cryptanalysis? Why are the S-boxes
optimized to make this attack as difficult as possible? Why are there as many
rounds as required, but no more? Because the designers knew about it. IBM’s
Don Coppersmith recently wrote [<a href="Applied%20Cryptography_split_035.html#r373" class="calibre5 pcalibre">373</a>,<a href="Applied%20Cryptography_split_035.html#r374" class="calibre5 pcalibre">374</a>]:</p>

<p class="quote">The design took advantage of certain cryptanalytic techniques,
most prominently the technique of “differential cryptanalysis,”
which were not known in the published literature. After
discussions with NSA, it was decided that disclosure of the design
consideration would reveal the technique of differential
cryptanalysis, a powerful technique that can be used against many
ciphers. This in turn would weaken the competitive advantage the
United States enjoyed over other countries in the field of
cryptography.</p>

<p class="calibre9">Adi Shamir responded to this, challenging Coppersmith to say that he hadn’t
found any stronger attacks against DES since then. Coppersmith has chosen to
remain silent on that question [<a href="Applied%20Cryptography_split_036.html#r1426" class="calibre5 pcalibre">1426</a>].</p>

<h4 class="calibre8">Related-Key Cryptanalysis</h4>

<p class="calibre9">Table 12.3 showed the number of bits the DES key is rotated after each round:
2 bits after each round, except for 1 bit after rounds 1, 2, 9, and 16. Why?</p>

<p class="calibre9"><b class="calibre10">Related-key cryptanalysis</b> is similar to differential cryptanalysis, but it
examines the difference between keys. The attack is different from any
previously discussed: The cryptanalyst chooses a relationship between a pair
of keys, but does not know the keys themselves. Data is encrypted with both
keys. In the known-plaintext version, the cryptanalyst knows the plaintext and
ciphertext of data encrypted with the two keys. In the chosen-plaintext version,
the cryptanalyst gets to choose the plaintext encrypted with the two keys.</p>

<p class="calibre9">A modified DES, where the key is rotated two bits after every round, is less
secure. Related-key cryptanalysis can break that variant using 2<sup class="calibre19">17</sup> chosen-key
chosen plaintexts or 2<sup class="calibre19">33</sup> chosen-key known plaintexts [<a href="Applied%20Cryptography_split_035.html#r158" class="calibre5 pcalibre">158</a>,<a href="Applied%20Cryptography_split_035.html#r163" class="calibre5 pcalibre">163</a>].</p>

<p class="calibre9">This attack is not at all practical, but it is interesting for three reasons. One, it
is the first cryptanalytic attack against DES’s subkey-generation algorithm.
Two, this attack is independent of the number of rounds of the cryptographic
algorithm; it’s just as effective against DES with 16 rounds, 32 rounds, or
1000 rounds. And three, DES is impervious to this attack. The variability in
the rotation thwarts related-key cryptanalysis.</p>

<h4 class="calibre8">Linear Cryptanalysis</h4>

<p class="calibre9"><b class="calibre10">Linear cryptanalysis</b> is another type of cryptanalytic attack, invented by
Mitsuru Matsui [<a href="Applied%20Cryptography_split_036.html#r1016" class="calibre5 pcalibre">1016</a>,<a href="Applied%20Cryptography_split_036.html#r1015" class="calibre5 pcalibre">1015</a>,<a href="Applied%20Cryptography_split_036.html#r1017" class="calibre5 pcalibre">1017</a>]. This attack uses linear approximations to
describe the action of a block cipher (in this case, DES.)</p>

<p class="calibre9">This means that if you XOR some of the plaintext bits together, XOR some
ciphertext bits together, and then XOR the result, you will get a single bit that
is the XOR of some of the key bits. This is a linear approximation and will
hold with some probability <i class="calibre12">p. </i> If <i class="calibre12">p</i> ≠ ½, then this bias can be exploited. Use collected plaintexts and associated ciphertexts to guess the values of the key
bits. The more data you have, the more reliable the guess. The greater the bias,
the greater the success rate with the same amount of data.</p>

<p class="calibre9">How do you identify good linear approximations for DES? Find good 1-round
linear approximations and join them together. (Again, ignore the initial and
final permutations; they don’t affect the attack.) Look at the S-boxes. There are
6 input bits and 4 output bits. The input bits can be combined using XOR in 63
useful ways (2<sup class="calibre19">6</sup> - 1), and the output bits can be combined in 15 useful ways.
Now, for each S-box you can evaluate the probability that for a randomly
chosen input, an input XOR combination equals some output XOR
combination. If there is a combination with a high enough bias, then linear
cryptanalysis may work.</p>

<p class="calibre9">If the linear approximations are unbiased, then they would hold for 32 of the
64 possible inputs. I’ll spare you the pages of tables, but the most biased S-box
is S-box 5. In fact, the second input bit is equal to the XOR of all 4 output bits
for only 12 inputs. This translates to a probability of 3/16, or a bias of 5/16, and is the most extreme bias in all the S-boxes. (Shamir noted this in [<a href="Applied%20Cryptography_split_036.html#r1423" class="calibre5 pcalibre">1423</a>], but
could not find a way to exploit it.)</p>

<p class="calibre9">Figure 12.8 shows how to turn this into an attack against the DES round
function. The input bit into S-box 5 is <i class="calibre12">b</i><sub class="calibre15">26</sub>. (I am numbering the bits from left to right and from 1 to 64. Matsui ignores this convention with DES and
numbers his bits from right to left and from 0 to 63. It’s enough to drive you
mad.) The 4 output bits from S-box 5 are <i class="calibre12">c</i><sub class="calibre15">17</sub>, <i class="calibre12">c</i><sub class="calibre15">18</sub>, <i class="calibre12">c</i><sub class="calibre15">19</sub> and <i class="calibre12">c</i><sub class="calibre15">20</sub>. We can trace <i class="calibre12">b</i><sub class="calibre15">26</sub>
backwards from the input to the S-box. The bit <i class="calibre12">a</i><sub class="calibre15">26</sub> is XORed with a bit from
the subkey <i class="calibre12">K</i><sub class="calibre15"><i class="calibre22">i</i>,26</sub> to obtain <i class="calibre12">b</i><sub class="calibre15">26</sub>. And bit <i class="calibre12">X</i><sub class="calibre15">17</sub> goes through the expansion permutation to become <i class="calibre12">a</i><sub class="calibre15">26</sub>. After the S-box, the 4 output bits go through the
P-box to become 4 output bits of the round function: <i class="calibre12">Y</i><sub class="calibre15">3</sub>, <i class="calibre12">Y</i><sub class="calibre15">8</sub>, <i class="calibre12">Y</i><sub class="calibre15">14</sub> and <i class="calibre12">Y</i><sub class="calibre15">25</sub>. This means that with probability ½ - 5/16 :</p>

<div class="figure" id="figure-12-8">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-8.png" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.8</b> A 1-round linear approximation for DES.</i></p>
</div>

<p class="math"><i class="calibre12">X</i><sub class="calibre15">17</sub> ⊕ <i class="calibre12">Y</i><sub class="calibre15">3</sub> ⊕ <i class="calibre12">Y</i><sub class="calibre15">8</sub> ⊕ <i class="calibre12">Y</i><sub class="calibre15">14</sub> ⊕ <i class="calibre12">Y</i><sub class="calibre15">25</sub> = <i class="calibre12">K</i><sub class="calibre15"><i class="calibre22">i</i>,26</sub>
</p>

<p class="calibre9">Linear approximations for different rounds can be joined in a manner similar
to that discussed under differential cryptanalysis. Figure 12.9 is a 3-round
approximation with a probability of ½ + .0061. The individual approximations
are of varying quality: The last is very good, the first is pretty good, and the
middle is bad. But together the three 1-round approximations give a very good
three-round approximation.</p>

<div class="figure" id="figure-12-9">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-9.png" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.9</b> A 3-round linear approximation for DES.</i></p>
</div>

<p class="calibre9">The basic attack is to use the best linear approximation for 16-round DES. It
requires 2<sup class="calibre19">47</sup> known plaintext blocks, and will result in 1 key bit. That’s not
very useful. If you interchange the role of plaintext and ciphertext and use
decryption as well as encryption, you can get 2 key bits. That’s still not very
useful.</p>

<p class="calibre9">There are refinements. Use a 14-round linear approximation for rounds 2
through 15. Guess the 6 subkey bits relevant to S-box 5 for the first and last
rounds (12 key bits in all). Effectively you are doing 2<sup class="calibre19">12</sup> linear cryptanalyses
in parallel and picking the correct one based on probabilities. This recovers the
12 bits plus the <i class="calibre12">b</i><sub class="calibre15">26</sub> and reversing plaintext and ciphertext recovers another 13
bits. To get the remaining 30 bits, use exhaustive search. There are other
tricks, but that’s basically it.</p>

<p class="calibre9">Against full 16-round DES, this attack can recover the key with an average of
2<sup class="calibre19">43</sup> known plaintexts. A software implementation of this attack recovered a
DES key in 50 days using 12 HP9000/735 workstations [<a href="Applied%20Cryptography_split_036.html#r1019" class="calibre5 pcalibre">1019</a>]. That is the
most effective attack against DES at the time of this writing.</p>

<p class="calibre9">Linear cryptanalysis is heavily dependent on the structure of the S-boxes and
the S-boxes in DES are not optimized against this attack. In fact, the ordering
of the S-boxes chosen for DES lies among the 9 percent to 16 percent that
offer the least protection against linear cryptanalysis [<a href="Applied%20Cryptography_split_036.html#r1018" class="calibre5 pcalibre">1018</a>]. According to Don
Coppersmith [<a href="Applied%20Cryptography_split_035.html#r373" class="calibre5 pcalibre">373</a>,<a href="Applied%20Cryptography_split_035.html#r374" class="calibre5 pcalibre">374</a>], resistance to linear cryptanalysis “was not part of the
design criteria of DES.” Either they didn’t know about linear cryptanalysis or
they knew about something else even more powerful whose resistance criteria
took precedence.</p>

<p class="calibre9">Linear cryptanalysis is newer than differential cryptanalysis, and there may be
more performance improvements in the coming years. Some ideas are
proposed in [<a href="Applied%20Cryptography_split_036.html#r1270" class="calibre5 pcalibre">1270</a>,<a href="Applied%20Cryptography_split_035.html#r811" class="calibre5 pcalibre">811</a>], but it is not clear that they can be used effectively
against full DES. They work very well against reduced round variants,
however.</p>

<h4 class="calibre8">Future Directions</h4>

<p class="calibre9">Some work has been done to try to extend the concept of differential
cryptanalysis to higher-order differentials [<a href="Applied%20Cryptography_split_035.html#r702" class="calibre5 pcalibre">702</a>,<a href="Applied%20Cryptography_split_035.html#r161" class="calibre5 pcalibre">161</a>,<a href="Applied%20Cryptography_split_036.html#r927" class="calibre5 pcalibre">927</a>,<a href="Applied%20Cryptography_split_036.html#r858" class="calibre5 pcalibre">858</a>,<a href="Applied%20Cryptography_split_036.html#r860" class="calibre5 pcalibre">860</a>]. Lars
Knudsen uses something called partial differentials to attack 6-round DES; it
requires 32 chosen plaintexts and 20,000 encryptions [<a href="Applied%20Cryptography_split_036.html#r860" class="calibre5 pcalibre">860</a>]. It is still too new
to know if these extensions will make it easier to attack full 16-round DES.</p>

<p class="calibre9">Another avenue of attack is <b class="calibre10">differential-linear cryptanalysis</b>: combining
differential and linear cryptanalysis. Susan Langford and Hellman have an
attack on 8-round DES that recovers 10 key bits with an 80 percent probability
of success with 512 chosen plaintexts and a 95 percent probability of success
with 768 chosen plaintexts [<a href="Applied%20Cryptography_split_036.html#r938" class="calibre5 pcalibre">938</a>]. After the attack, a brute-force search of the
remaining keyspace (2<sup class="calibre19">46</sup> possible keys) is required. While this attack is
comparable in time to previous attacks, it requires far less plaintext. However,
it doesn’t seem to extend easily to more rounds.</p>

<p class="calibre9">But this attack is still new and work continues. It is possible that there may be
a breakthrough some time during the next few years. Maybe there are benefits
in combining this attack with higher-order differential cryptanalysis. Who
knows?</p>

<h3 id="12.5" class="calibre7">12.5 The Real Design Criteria</h3>

<p class="calibre9">After differential cryptanalysis became public, IBM published the design
criteria for the S-boxes and the P-box [<a href="Applied%20Cryptography_split_035.html#r373" class="calibre5 pcalibre">373</a>,<a href="Applied%20Cryptography_split_035.html#r374" class="calibre5 pcalibre">374</a>]. The criteria for the S-boxes
are:</p>

<ul class="calibre13">

<li class="calibre14">Each S-box has 6 input bits and 4 output bits. (This was the largest
size that could be accommodated in a single chip with 1974
technology.)
</li>
<li class="calibre14">No output bit of an S-box should be too close to a linear function of
the input bits.
</li>
<li class="calibre14">If you fix the left-most and right-most bits of an S-box and vary the 4
middle bits, each possible 4-bit output is attained exactly once.
</li>
<li class="calibre14">If two inputs to an S-box differ in exactly 1 bit, the outputs must
differ in at least 2 bits.
</li>
<li class="calibre14">If two inputs to an S-box differ in the 2 middle bits exactly, the
outputs must differ in at least 2 bits.
</li>
<li class="calibre14">If two inputs to an S-box differ in their first 2 bits and are identical in
their last 2 bits, the two outputs must not be the same.
</li>
<li class="calibre14">For any nonzero 6-bit difference between inputs, no more than 8 of
the 32 pairs of inputs exhibiting that difference may result in the same
output difference.
</li>
<li class="calibre14">A criterion similar to the previous one, but for the case of three active
S-boxes.
</li>

</ul>

<p class="calibre9">The criteria for the P-box are:</p>

<ul class="calibre13">

<li class="calibre14">The 4 output bits from each S-box in round i are distributed so that 2
of them affect the middle-bits of S-boxes at round <i class="calibre12">i</i> + 1 and the other 2
affect end bits.
</li>
<li class="calibre14">The 4 output bits from each S-box affect six different S-boxes; no 2
affect the same S-box.
</li>
<li class="calibre14">If the output bit from one S-box affects a middle bit of another
S-box, then an output bit from that other S-box cannot affect a middle
bit of the first S-box.
</li>

</ul>

<p class="calibre9">The paper goes on to discuss the criteria. Generating S-boxes is pretty easy
today, but was a complicated task in the early 1970s. Tuchman has been
quoted as saying that they ran computer programs for months cooking up the
S-boxes.</p>

<h3 id="12.6" class="calibre7">12.6 DES Variants</h3>

<h4 class="calibre8">Multiple DES</h4>

<p class="calibre9">Some DES implementations use triple-DES (see Figure 12.10) [<a href="Applied%20Cryptography_split_035.html#r55" class="calibre5 pcalibre">55</a>]. Since
DES is not a group, then the resultant ciphertext is much harder to break using
exhaustive search: 2<sup class="calibre19">112</sup> attempts instead of 2<sup class="calibre19">56</sup> attempts. See <a href="Applied%20Cryptography_split_018.html#15.2" class="calibre5 pcalibre">Section 15.2</a> for
more details.</p>

<div class="figure" id="figure-12-10">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-10.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.10</b> Triple-DES.</i></p>
</div>

<h4 class="calibre8">DES with Independent Subkeys</h4>

<p class="calibre9">Another variation is to use a different subkey for each round, instead of
generating them from a single 56-bit key [<a href="Applied%20Cryptography_split_036.html#r851" class="calibre5 pcalibre">851</a>]. Since 48 key bits are used in
each of 16 rounds, this means that the key length for this variant is 768 bits.
This variant would drastically increase the difficulty of a brute-force attack
against the algorithm; that attack would have a complexity of 2<sup class="calibre19">768</sup>.</p>

<p class="calibre9">However, a meet-in-the-middle attack (see <a href="Applied%20Cryptography_split_018.html#15.1" class="calibre5 pcalibre">Section 15.1</a>) would be possible.
This would reduce the complexity of attack to 2<sup class="calibre19">384</sup>; still long enough for any
conceivable security needs.</p>

<p class="calibre9">Although independent subkeys foil linear cryptanalysis, this variant is
susceptible to differential cryptanalysis and can be broken with 2<sup class="calibre19">61</sup> chosen
plaintexts (see Table 12.15) [<a href="Applied%20Cryptography_split_035.html#r167" class="calibre5 pcalibre">167</a>,<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>]. It would seem that any modification of
the key schedule cannot make DES much stronger.</p>

<table class="data-table1" id="table-12-15">
<caption class="calibre67">Table 12.15 - 	Differential Cryptanalysis Attacks against DES Variants</caption>
<tbody class="calibre24"><tr class="calibre68">
<th class="calibre26">Modified Operation</th>
<th class="calibre26">Chosen Plaintexts</th>
</tr>
<tr class="calibre25"><td class="calibre61">Full DES (no modification)</td><td class="calibre61">2<sup class="calibre47">47</sup></td></tr>
<tr class="calibre25"><td class="calibre61">P permutation</td><td class="calibre61">Cannot strengthen</td></tr>
<tr class="calibre25"><td class="sub-item">Identity permutation</td><td class="calibre61">2<sup class="calibre47">19</sup></td></tr>
<tr class="calibre25"><td class="calibre61">Order of S-boxes</td><td class="calibre61">2<sup class="calibre47">38</sup></td></tr>
<tr class="calibre25"><td class="calibre61">Replace XORs by additions</td><td class="calibre61">2<sup class="calibre47">39</sup>, 2<sup class="calibre47">31</sup></td></tr>
<tr class="calibre25"><td class="calibre61">S-boxes:</td><td class="calibre61"/></tr>
<tr class="calibre25"><td class="sub-item">Random</td><td class="calibre61">2<sup class="calibre47">18</sup>-2<sup class="calibre47">20</sup></td></tr>
<tr class="calibre25"><td class="sub-item">Random permutations</td><td class="calibre61">2<sup class="calibre47">33</sup>-2<sup class="calibre47">41</sup></td></tr>
<tr class="calibre25"><td class="sub-item">One entry</td><td class="calibre61">2<sup class="calibre47">33</sup></td></tr>
<tr class="calibre25"><td class="sub-item">Uniform tables</td><td class="calibre61">2<sup class="calibre47">26</sup></td></tr>
<tr class="calibre25"><td class="calibre61">Elimination of the E Expansion</td><td class="calibre61">2<sup class="calibre47">26</sup></td></tr>
<tr class="calibre25"><td class="calibre61">Order of E and subkey XOR</td><td class="calibre61">2<sup class="calibre47">44</sup></td></tr>
<tr class="calibre25"><td class="calibre61">GDES (width q = 8):</td><td class="calibre61"/></tr>
<tr class="calibre71"><td class="sub-item1">16 rounds</td><td class="calibre78">6, 16</td></tr>
<tr class="calibre25"><td class="sub-item">64 rounds</td><td class="calibre61">2<sup class="calibre47">49</sup> (independent key)</td></tr>
</tbody></table>

<h4 class="calibre8">DESX</h4>

<p class="calibre9">DESX is a DES variant from RSA Data Security, Inc. that has been included in
the MailSafe electronic mail security program since 1986 and the BSAFE
toolkit since 1987. DESX uses a technique called whitening (see <a href="Applied%20Cryptography_split_018.html#15.6" class="calibre5 pcalibre">Section 15.6</a>)
to obscure the inputs and outputs to DES. In addition to a 56-bit DES key,
DESX has an additional 64-bit whitening key. These 64 bits are XORed to the
plaintext before the first round of DES. An additional 64 bits, computed as a
one-way function of the entire 120-bit DES key, is XORed to the ciphertext
after the last round [<a href="Applied%20Cryptography_split_035.html#r155" class="calibre5 pcalibre">155</a>]. Whitening makes DESX much stronger than DES
against a brute-force attack; the attack requires (2<sup class="calibre19">120</sup>)/<i class="calibre12">n</i> operations with <i class="calibre12">n</i> known plaintexts. It also improves security against differential and linear
cryptanalysis; the attacks require 2<sup class="calibre19">61</sup> chosen plaintexts and 2<sup class="calibre19">60</sup> known
plaintexts, respectively [<a href="Applied%20Cryptography_split_036.html#r1338" class="calibre5 pcalibre">1338</a>].</p>

<h4 class="calibre8">CRYPT(3)</h4>

<p class="calibre9">CRYPT(3) is a DES variant found on UNIX systems. It is primarily used as a
one-way function for passwords, but sometimes can also be used for
encryption. The difference between CRYPT(3) and DES is that CRYPT(3) has
a key-dependent expansion permutation with 2<sup class="calibre19">12</sup> possible permutations. This
was done primarily so that off-the-shelf DES chips could not be used to
construct a hardware password-cracker.</p>

<h4 class="calibre8">Generalized DES</h4>

<p class="calibre9">Generalized DES (GDES) was designed both to speed up DES and to
strengthen the algorithm [<a href="Applied%20Cryptography_split_036.html#r1381" class="calibre5 pcalibre">1381</a>,<a href="Applied%20Cryptography_split_036.html#r1382" class="calibre5 pcalibre">1382</a>]. The overall block size increases while
the amount of computation remains constant.</p>

<p class="calibre9">Figure 12.11 is a block diagram of GDES. GDES operates on variable-sized
blocks of plaintext. Encryption blocks are divided up into <i class="calibre12">q</i> 32-bit sub-blocks; the exact number depends on the total block size (this was variable in the
design, but must be fixed for each implementation). In general, <i class="calibre12">q</i> equals the
block size divided by 32.</p>

<div class="figure" id="figure-12-11">
<div class="image1">
<p class="calibre9"><img src="ac-figure-12-11.jpg" class="calibre11"/></p>
</div>
<p class="calibre9"><i class="calibre12"><b class="calibre10">Figure 12.11</b> GDES.</i></p>
</div>

<p class="calibre9">Function f is calculated once per round on the right-most block. The result is
XORed with all the other parts, which are then rotated to the right. GDES has
a variable number of rounds, <i class="calibre12">n</i>. There is a slight modification to the last round, so that the encryption and decryption processes differ only in the order of the
subkeys (just like DES). In fact, if <i class="calibre12">q</i> = 2 and <i class="calibre12">n</i> = 16, this <i class="calibre12">is</i> DES.</p>

<p class="calibre9">Biham and Shamir [<a href="Applied%20Cryptography_split_035.html#r167" class="calibre5 pcalibre">167</a>,<a href="Applied%20Cryptography_split_035.html#r168" class="calibre5 pcalibre">168</a>] showed that, using differential cryptanalysis,
GDES with <i class="calibre12">q</i> = 8 and <i class="calibre12">n</i> = 16 is breakable with only six chosen plaintexts. If independent subkeys are also used, 16 chosen plaintexts are required. GDES
with <i class="calibre12">q</i> = 8 and <i class="calibre12">n</i> = 22 is breakable with 48 chosen plaintexts, and GDES with <i class="calibre12">q</i>
= 8 and <i class="calibre12">n</i> = 31 requires only 500,000 chosen plaintexts to break. Even GDES
with <i class="calibre12">q</i> = 8 and <i class="calibre12">n</i> = 64 is weaker than DES; 2<sup class="calibre19">49</sup> chosen plaintexts are required to break it. In fact, any GDES scheme that is faster than DES is also less
secure (see Table 12.15).</p>

<p class="calibre9">A variant of this scheme recently appeared [<a href="Applied%20Cryptography_split_036.html#r1591" class="calibre5 pcalibre">1591</a>]. It is probably no more
secure than the original GDES. In general, any large block DES variant that is
faster than DES is probably also less secure than DES.</p>

<h4 class="calibre8">DES with Alternate S-Boxes</h4>

<p class="calibre9">Other DES modifications centered around the S-boxes. Some designs made the
order of the S-boxes variable. Other designers varied the contents of the
S-boxes themselves. Biham and Shamir showed [<a href="Applied%20Cryptography_split_035.html#r170" class="calibre5 pcalibre">170</a>,<a href="Applied%20Cryptography_split_035.html#r172" class="calibre5 pcalibre">172</a>] that the design of
the S-boxes, and even the order of the S-boxes themselves, were optimized
against differential cryptanalysis:</p>

<p class="quote">The replacement of the order of the eight DES S-boxes (without
changing their value) also makes DES much weaker: DES with
16 rounds of a particular replaced order is breakable in about 2<sup class="calibre19">38</sup>
steps.... DES with random S-boxes is shown to be very easy to
break. Even a minimal change of one entry of one of the DES
S-boxes can make DES easier to break.</p>

<p class="calibre9">The DES S-boxes were not optimized against linear cryptanalysis. There are
better S-boxes than the ones that come with DES, but blindly choosing new
S-boxes isn’t a good idea.</p>

<p class="calibre9">Table 12.15 [<a href="Applied%20Cryptography_split_035.html#r167" class="calibre5 pcalibre">167</a>,<a href="Applied%20Cryptography_split_035.html#r169" class="calibre5 pcalibre">169</a>] lists some modifications to DES and the number of
chosen plaintexts required for differential cryptanalysis. One change not listed,
combining the left and right halves using addition mod 2<sup class="calibre19">4</sup> instead of XOR, is
2<sup class="calibre19">17</sup> times harder to break than DES [<a href="Applied%20Cryptography_split_035.html#r689" class="calibre5 pcalibre">689</a>].</p>

<h4 class="calibre8">RDES</h4>

<p class="calibre9">RDES is a variant that replaces swapping the left and right halves at the end of
each round with a key-dependent swap [<a href="Applied%20Cryptography_split_036.html#r893" class="calibre5 pcalibre">893</a>]. The swappings are fixed,
depending solely on the key. This means that the 15 key-dependent swaps
occur with 2<sup class="calibre19">15</sup> possible instances, and that the variant is not resistant to
differential cryptanalysis [<a href="Applied%20Cryptography_split_035.html#r816" class="calibre5 pcalibre">816</a>,<a href="Applied%20Cryptography_split_036.html#r894" class="calibre5 pcalibre">894</a>,<a href="Applied%20Cryptography_split_035.html#r112" class="calibre5 pcalibre">112</a>]. RDES has a large number of weak
keys. In fact, almost every key is weaker than a typical DES key. This variant
should not be used.</p>

<p class="calibre9">A better idea is to swap only within the right half, at the beginning of each
round. Another better idea is to make the swapping dependent on the input
data and not a static function of the key. There are a number of possible
variants [<a href="Applied%20Cryptography_split_035.html#r813" class="calibre5 pcalibre">813</a>,<a href="Applied%20Cryptography_split_035.html#r815" class="calibre5 pcalibre">815</a>]. In RDES-1, there is a data-dependent swap of the 16-bit
words at the beginning of each round. In RDES-2, there is a data-dependent
swap of the bytes at the beginning of each round after the 16-bit swappings as
in RDES-1. And so on through RDES-4. RDES-1 is secure against both
differential cryptanalysis [<a href="Applied%20Cryptography_split_035.html#r815" class="calibre5 pcalibre">815</a>] and linear cryptanalysis [<a href="Applied%20Cryptography_split_036.html#r1136" class="calibre5 pcalibre">1136</a>]. Presumably
RDES-2 and greater are as well.</p>

<h4 class="calibre8">s<sup class="calibre19">n</sup> DES</h4>

<p class="calibre9">A group of Korean researchers, led by Kwangjo Kim, has attempted to find a
set of S-boxes that are optimally secure against both linear and differential
cryptanalysis. Their first attempt, known as <i class="calibre12">s</i><sup class="calibre19">2</sup>DES, was presented in [<a href="Applied%20Cryptography_split_036.html#r834" class="calibre5 pcalibre">834</a>] and shown to be worse than DES against differential cryptanalysis in [<a href="Applied%20Cryptography_split_036.html#r855" class="calibre5 pcalibre">855</a>,<a href="Applied%20Cryptography_split_036.html#r858" class="calibre5 pcalibre">858</a>].
Their next attempt, <i class="calibre12">s</i><sup class="calibre19">3</sup>DES, was presented in [<a href="Applied%20Cryptography_split_036.html#r839" class="calibre5 pcalibre">839</a>] and shown to be worse than
DES against linear cryptanalysis [<a href="Applied%20Cryptography_split_036.html#r856" class="calibre5 pcalibre">856</a>,<a href="Applied%20Cryptography_split_036.html#r1491" class="calibre5 pcalibre">1491</a>,<a href="Applied%20Cryptography_split_036.html#r1527" class="calibre5 pcalibre">1527</a>,<a href="Applied%20Cryptography_split_036.html#r858" class="calibre5 pcalibre">858</a>,<a href="Applied%20Cryptography_split_036.html#r838" class="calibre5 pcalibre">838</a>]. Biham suggested a
minor change to make <i class="calibre12">s</i><sup class="calibre19">3</sup>DES secure against both linear and differential
cryptanalysis [<a href="Applied%20Cryptography_split_035.html#r165" class="calibre5 pcalibre">165</a>]. The group went back to their computers and developed
better techniques for S-box design [<a href="Applied%20Cryptography_split_036.html#r835" class="calibre5 pcalibre">835</a>,<a href="Applied%20Cryptography_split_036.html#r837" class="calibre5 pcalibre">837</a>]. They proposed <i class="calibre12">s</i><sup class="calibre19">4</sup>DES [<a href="Applied%20Cryptography_split_036.html#r836" class="calibre5 pcalibre">836</a>] and
then <i class="calibre12">s</i><sup class="calibre19">5</sup>DES [<a href="Applied%20Cryptography_split_036.html#r838" class="calibre5 pcalibre">838</a>,<a href="Applied%20Cryptography_split_036.html#r944" class="calibre5 pcalibre">944</a>].</p>

<p class="calibre9">Table 12.16 gives the <i class="calibre12">s</i><sup class="calibre19">3</sup>DES S-boxes with S-box 1 and S-box 2 reversed,
which are secure against both differential and linear cryptanalysis. Sticking
this variant in a triple-DES mix is sure to irritate cryptanalysts.</p>

<table class="data-table1" id="table-12-16">
<caption class="calibre67">Table 12.16 - 3DES S-Boxes (with S-box 1 and S-box 2 reversed)</caption>
<tbody class="calibre24"><tr class="calibre68"><td class="title3" colspan="16">S-box 1:</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">4</td><td class="calibre70">7</td><td class="calibre70">9</td><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">1</td><td class="calibre70">15</td><td class="calibre70">2</td><td class="calibre70">5</td></tr>
<tr class="calibre25"><td class="calibre70">8</td><td class="calibre70">2</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">1</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">5</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">12</td></tr>
<tr class="calibre25"><td class="calibre70">14</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">8</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">1</td><td class="calibre70">2</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">2</td><td class="calibre70">6</td><td class="calibre70">3</td><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">12</td><td class="calibre70">0</td><td class="calibre70">15</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 2:</td></tr>
<tr class="calibre25"><td class="calibre70">15</td><td class="calibre70">8</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">11</td><td class="calibre70">10</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">7</td><td class="calibre70">6</td><td class="calibre70">12</td></tr>
<tr class="calibre25"><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">12</td><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">13</td><td class="calibre70">8</td><td class="calibre70">4</td><td class="calibre70">11</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">1</td><td class="calibre70">7</td></tr>
<tr class="calibre25"><td class="calibre70">9</td><td class="calibre70">14</td><td class="calibre70">5</td><td class="calibre70">8</td><td class="calibre70">2</td><td class="calibre70">4</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">10</td><td class="calibre70">7</td><td class="calibre70">6</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">0</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">1</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">4</td><td class="calibre70">11</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 3:</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">3</td><td class="calibre70">11</td><td class="calibre70">5</td><td class="calibre70">14</td><td class="calibre70">8</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">4</td><td class="calibre70">15</td><td class="calibre70">1</td><td class="calibre70">12</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">10</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">8</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">14</td><td class="calibre70">11</td><td class="calibre70">15</td><td class="calibre70">10</td><td class="calibre70">12</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">6</td></tr>
<tr class="calibre25"><td class="calibre70">6</td><td class="calibre70">5</td><td class="calibre70">8</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">9</td><td class="calibre70">2</td><td class="calibre70">4</td><td class="calibre70">1</td><td class="calibre70">10</td><td class="calibre70">7</td><td class="calibre70">15</td><td class="calibre70">12</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">11</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">6</td><td class="calibre70">12</td><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">9</td><td class="calibre70">5</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 4:</td></tr>
<tr class="calibre25"><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">7</td><td class="calibre70">11</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">1</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">4</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">0</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">14</td><td class="calibre70">4</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">7</td><td class="calibre70">9</td><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">15</td><td class="calibre70">1</td></tr>
<tr class="calibre25"><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">10</td><td class="calibre70">5</td><td class="calibre70">12</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">8</td><td class="calibre70">11</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 5:</td></tr>
<tr class="calibre25"><td class="calibre70">5</td><td class="calibre70">15</td><td class="calibre70">9</td><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">7</td><td class="calibre70">1</td><td class="calibre70">13</td><td class="calibre70">6</td><td class="calibre70">8</td><td class="calibre70">11</td></tr>
<tr class="calibre25"><td class="calibre70">6</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">5</td><td class="calibre70">12</td><td class="calibre70">0</td><td class="calibre70">10</td><td class="calibre70">8</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">11</td><td class="calibre70">14</td><td class="calibre70">1</td></tr>
<tr class="calibre25"><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">5</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">8</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">6</td><td class="calibre70">12</td><td class="calibre70">13</td><td class="calibre70">2</td></tr>
<tr class="calibre25"><td class="calibre70">12</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">2</td><td class="calibre70">14</td><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">1</td><td class="calibre70">4</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 6:</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">14</td><td class="calibre70">13</td><td class="calibre70">15</td><td class="calibre70">5</td><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">2</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">14</td><td class="calibre70">13</td><td class="calibre70">11</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">7</td><td class="calibre70">1</td><td class="calibre70">8</td><td class="calibre70">9</td><td class="calibre70">10</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">12</td><td class="calibre70">6</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">0</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">4</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">14</td><td class="calibre70">1</td><td class="calibre70">15</td><td class="calibre70">6</td><td class="calibre70">12</td><td class="calibre70">8</td><td class="calibre70">5</td><td class="calibre70">11</td><td class="calibre70">2</td></tr>
<tr class="calibre25"><td class="calibre70">1</td><td class="calibre70">7</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">13</td><td class="calibre70">2</td><td class="calibre70">10</td><td class="calibre70">12</td><td class="calibre70">3</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">0</td><td class="calibre70">9</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 7:</td></tr>
<tr class="calibre25"><td class="calibre70">4</td><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">2</td><td class="calibre70">9</td><td class="calibre70">1</td><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">3</td><td class="calibre70">7</td><td class="calibre70">14</td><td class="calibre70">13</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">6</td><td class="calibre70">0</td><td class="calibre70">5</td><td class="calibre70">3</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">1</td><td class="calibre70">8</td><td class="calibre70">11</td><td class="calibre70">13</td><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">7</td><td class="calibre70">2</td></tr>
<tr class="calibre25"><td class="calibre70">2</td><td class="calibre70">12</td><td class="calibre70">9</td><td class="calibre70">6</td><td class="calibre70">15</td><td class="calibre70">10</td><td class="calibre70">4</td><td class="calibre70">1</td><td class="calibre70">5</td><td class="calibre70">11</td><td class="calibre70">3</td><td class="calibre70">0</td><td class="calibre70">8</td><td class="calibre70">7</td><td class="calibre70">14</td><td class="calibre70">13</td></tr>
<tr class="calibre25"><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">5</td><td class="calibre70">10</td><td class="calibre70">15</td><td class="calibre70">2</td><td class="calibre70">13</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">7</td><td class="calibre70">11</td><td class="calibre70">1</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="title3" colspan="16">S-box 8:</td></tr>
<tr class="calibre25"><td class="calibre70">13</td><td class="calibre70">10</td><td class="calibre70">0</td><td class="calibre70">7</td><td class="calibre70">3</td><td class="calibre70">9</td><td class="calibre70">14</td><td class="calibre70">4</td><td class="calibre70">2</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">1</td><td class="calibre70">5</td><td class="calibre70">6</td><td class="calibre70">11</td><td class="calibre70">8</td></tr>
<tr class="calibre25"><td class="calibre70">2</td><td class="calibre70">7</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">4</td><td class="calibre70">14</td><td class="calibre70">11</td><td class="calibre70">8</td><td class="calibre70">15</td><td class="calibre70">12</td><td class="calibre70">6</td><td class="calibre70">10</td><td class="calibre70">9</td><td class="calibre70">5</td><td class="calibre70">0</td><td class="calibre70">3</td></tr>
<tr class="calibre71"><td class="calibre72">4</td><td class="calibre72">13</td><td class="calibre72">14</td><td class="calibre72">0</td><td class="calibre72">9</td><td class="calibre72">3</td><td class="calibre72">7</td><td class="calibre72">10</td><td class="calibre72">1</td><td class="calibre72">8</td><td class="calibre72">2</td><td class="calibre72">11</td><td class="calibre72">15</td><td class="calibre72">5</td><td class="calibre72">12</td><td class="calibre72">6</td></tr>
<tr class="calibre25"><td class="calibre70">8</td><td class="calibre70">11</td><td class="calibre70">7</td><td class="calibre70">14</td><td class="calibre70">2</td><td class="calibre70">4</td><td class="calibre70">13</td><td class="calibre70">1</td><td class="calibre70">6</td><td class="calibre70">5</td><td class="calibre70">9</td><td class="calibre70">0</td><td class="calibre70">12</td><td class="calibre70">15</td><td class="calibre70">3</td><td class="calibre70">10</td></tr>
</tbody></table>


<h4 class="calibre8">DES with Key-Dependent S-Boxes</h4>

<p class="calibre9">Linear and differential cryptanalysis work only if the analyst knows the
composition of the S-boxes. If the S-boxes are key-dependent and chosen by a
cryptographically strong method, then linear and differential cryptanalysis are
much more difficult. Remember though, that randomly generated S-boxes
have very poor differential and linear characteristics; even if they are secret.</p>

<p class="calibre9">Here is a method to use 48 additional key bits to generate S-boxes that are
resistant to both linear and differential cryptanalysis [<a href="Applied%20Cryptography_split_035.html#r165" class="calibre5 pcalibre">165</a>].</p>

<ol class="calibre17">

<li class="calibre14">Rearrange the DES S-boxes: 24673158.
</li>
<li class="calibre14">Select 16 of the remaining key bits. If the first bit is 1, swap the first two rows of S-box 1 with the last two rows of S-box 1. If the second bit
is a 1, swap the first eight columns of S-box 1 with the second eight
columns of S-box 1. Do the same to S-box 2 with the third and fourth
key bits. Do the same with S-boxes 3 through 8.
</li>
<li class="calibre14">Take the remaining 32 key bits. XOR the first four with every entry
of S-box 1, the second four with every entry of S-box 2 and so on.
</li>

</ol>

<p class="calibre9">The complexity of a differential cryptanalysis attack against this system is 2<sup class="calibre19">51</sup>;
the complexity of a linear cryptanalysis attack is 2<sup class="calibre19">53</sup>. The complexity of
exhaustive search is 2<sup class="calibre19">102</sup>.</p>

<p class="calibre9">What is neat about this DES variant is that it can be implemented in existing
hardware. Several DES chip vendors sell DES chips with loadable S-boxes.
This S-box generation method can be done outside the chip and then loaded in.
Differential and linear cryptanalysis require so much known or chosen
plaintext as to be unworkable, and a brute-force attack is inconceivable — with
no speed penalties.</p>

<h3 id="12.7" class="calibre7">12.7 How Secure Is DES Today? </h3>

<p class="calibre9">The answer is both easy and hard. The easy answer just looks at key length
(see <a href="Applied%20Cryptography_split_009.html#7.1" class="calibre5 pcalibre">Section 7.1</a>). A brute-force DES-cracking machine that can find a key in
an average of 3.5 hours cost only $1 million in 1993 [<a href="Applied%20Cryptography_split_036.html#r1597" class="calibre5 pcalibre">1597</a>,<a href="Applied%20Cryptography_split_036.html#r1598" class="calibre5 pcalibre">1598</a>]. DES is so
widespread that it is naïve to pretend that the NSA and its counterparts haven’t
built such a machine. And remember that cost will drop by a factor of 5 every
10 years. DES will only become less secure as time goes on.</p>

<p class="calibre9">The hard answer tries to estimate cryptanalytic techniques. Differential
cryptanalysis was known by the NSA long before the mid-1970s, when DES
first became a standard. It is naïve to pretend that the NSA theoreticians have
been idle since then; almost certainly they have developed newer cryptanalytic
techniques that can be applied against DES. But there are no facts, only
rumors.</p>

<p class="calibre9">Winn Schwartau writes that the NSA had built a massively parallel
DES-cracking machine as early as the mid-1980s [<a href="Applied%20Cryptography_split_036.html#r1404" class="calibre5 pcalibre">1404</a>]. At least one such
machine was built by Harris Corp. with a Cray Y-MP as a front end.
Supposedly there are a series of algorithms that can reduce the complexity of a
DES brute-force search by several orders of magnitude. Contextual algorithms,
based on the inner workings of DES, can scrap sets of possible keys based on
partial solutions. Statistical algorithms reduce the effective key size even
further. And other algorithms choose likely keys — words, printable ASCII, and
so on (see <a href="Applied%20Cryptography_split_010.html#8.1" class="calibre5 pcalibre">Section 8.1</a>) — to test. The rumor is that the NSA can crack DES in 3
to 15 minutes, depending on how much preprocessing they can do. And these
machines cost only $50,000 each, in quantity.</p>

<p class="calibre9">A different rumor is that if the NSA has a large amount of plaintext and
ciphertext, its experts can perform some kind of statistical calculation and then
go out to an array of optical disks and retrieve the key.</p>

<p class="calibre9">These are just rumors, but they don’t give me a warm, fuzzy feeling about
DES. It has just been too big a target for too long. Almost any change to DES
will be more annoying; maybe the resultant cipher will be easier to break, but
the NSA might not have the resources to devote to the problem.</p>

<p class="calibre9">My recommendation is to use Biham’s construction for key-dependent
S-boxes. It is easy to implement in software and in hardware chips that have
loadable S-boxes, and has no performance penalty over DES. It increases the
algorithm’s resistance to a brute-force attack, makes differential and linear
cryptanalysis harder, and gives the NSA something at least as strong as
DES — but different — to worry about.</p>

<div class="calibre6" id="calibre_pb_30"></div>
</div>






</body></html>
